<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Budget Tracker Pro</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <style>
      :root {
        /* Colors */
        --primary-color: #6366f1;
        --primary-hover: #4f46e5;
        --secondary-color: #f43f5e;
        --secondary-hover: #e11d48;
        --success-color: #10b981;
        --warning-color: #f59e0b;
        --danger-color: #ef4444;
        --info-color: #3b82f6;

        /* Text Colors */
        --text-primary: #1e293b;
        --text-secondary: #64748b;
        --text-muted: #94a3b8;

        /* Background Colors */
        --bg-primary: #ffffff;
        --bg-secondary: #f8fafc;
        --bg-tertiary: #f1f5f9;
        --bg-sidebar: #1e293b;

        /* Border Colors */
        --border-color: #e2e8f0;
        --border-light: #f1f5f9;

        /* Income/Expense Colors */
        --income-color: #10b981;
        --expense-color: #ef4444;

        /* Chart Colors */
        --chart-color-1: #6366f1;
        --chart-color-2: #f43f5e;
        --chart-color-3: #10b981;
        --chart-color-4: #f59e0b;
        --chart-color-5: #3b82f6;
        --chart-color-6: #8b5cf6;
        --chart-color-7: #ec4899;
        --chart-color-8: #14b8a6;

        /* Shadows */
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1),
          0 1px 2px 0 rgba(0, 0, 0, 0.06);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);

        /* Spacing */
        --spacing-xs: 0.25rem;
        --spacing-sm: 0.5rem;
        --spacing-md: 1rem;
        --spacing-lg: 1.5rem;
        --spacing-xl: 2rem;
        --spacing-2xl: 3rem;

        /* Border Radius */
        --radius-sm: 0.25rem;
        --radius: 0.5rem;
        --radius-md: 0.75rem;
        --radius-lg: 1rem;
        --radius-full: 9999px;

        /* Transitions */
        --transition-fast: 150ms ease;
        --transition: 300ms ease;
        --transition-slow: 500ms ease;

        /* Font Sizes */
        --text-xs: 0.75rem;
        --text-sm: 0.875rem;
        --text-base: 1rem;
        --text-lg: 1.125rem;
        --text-xl: 1.25rem;
        --text-2xl: 1.5rem;
        --text-3xl: 1.875rem;
        --text-4xl: 2.25rem;

        /* Font Weights */
        --font-light: 300;
        --font-normal: 400;
        --font-medium: 500;
        --font-semibold: 600;
        --font-bold: 700;

        /* Layout */
        --sidebar-width: 280px;
        --header-height: 70px;
      }

      /* Dark Theme */
      .dark-theme {
        --primary-color: #818cf8;
        --primary-hover: #6366f1;
        --secondary-color: #fb7185;
        --secondary-hover: #f43f5e;

        --text-primary: #f1f5f9;
        --text-secondary: #cbd5e1;
        --text-muted: #94a3b8;

        --bg-primary: #0f172a;
        --bg-secondary: #1e293b;
        --bg-tertiary: #334155;
        --bg-sidebar: #0f172a;

        --border-color: #334155;
        --border-light: #1e293b;
      }

      /* Reset & Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        font-size: 16px;
      }

      body {
        font-family: "Inter", sans-serif;
        color: var(--text-primary);
        background-color: var(--bg-secondary);
        line-height: 1.5;
        transition: background-color var(--transition), color var(--transition);
      }

      a {
        color: var(--primary-color);
        text-decoration: none;
        transition: color var(--transition-fast);
      }

      a:hover {
        color: var(--primary-hover);
      }

      button {
        cursor: pointer;
        font-family: inherit;
      }

      input,
      select,
      textarea {
        font-family: inherit;
      }

      /* App Container */
      .app-container {
        display: flex;
        min-height: 100vh;
      }

      /* Sidebar */
      .sidebar {
        width: var(--sidebar-width);
        background-color: var(--bg-sidebar);
        color: #fff;
        display: flex;
        flex-direction: column;
        position: fixed;
        height: 100vh;
        z-index: 10;
        transition: transform var(--transition);
      }

      .sidebar-header {
        padding: var(--spacing-lg);
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .logo {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .logo h1 {
        font-size: var(--text-xl);
        font-weight: var(--font-bold);
      }

      .logo span {
        color: var(--primary-color);
      }

      .theme-toggle {
        background: transparent;
        border: none;
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        border-radius: var(--radius-full);
        transition: background-color var(--transition-fast);
      }

      .theme-toggle:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      .sun-icon,
      .moon-icon {
        transition: opacity var(--transition-fast),
          transform var(--transition-fast);
      }

      .dark-theme .sun-icon {
        opacity: 1;
        transform: rotate(0);
      }

      .dark-theme .moon-icon {
        opacity: 0;
        transform: rotate(90deg);
        position: absolute;
      }

      .sun-icon {
        opacity: 0;
        transform: rotate(-90deg);
        position: absolute;
      }

      .moon-icon {
        opacity: 1;
        transform: rotate(0);
      }

      .sidebar-nav {
        flex: 1;
        padding: var(--spacing-lg) 0;
        overflow-y: auto;
      }

      .sidebar-nav ul {
        list-style: none;
      }

      .sidebar-nav li {
        padding: var(--spacing-md) var(--spacing-xl);
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        color: rgba(255, 255, 255, 0.7);
        cursor: pointer;
        transition: background-color var(--transition-fast),
          color var(--transition-fast);
        position: relative;
      }

      .sidebar-nav li:hover {
        background-color: rgba(255, 255, 255, 0.05);
        color: #fff;
      }

      .sidebar-nav li.active {
        color: #fff;
        background-color: rgba(255, 255, 255, 0.1);
      }

      .sidebar-nav li.active::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 4px;
        background-color: var(--primary-color);
      }

      .sidebar-nav li svg {
        width: 20px;
        height: 20px;
        flex-shrink: 0;
      }

      .sidebar-footer {
        padding: var(--spacing-lg);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .user-profile {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
      }

      .avatar {
        width: 40px;
        height: 40px;
        border-radius: var(--radius-full);
        overflow: hidden;
        background-color: var(--primary-color);
      }

      .avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .user-info {
        overflow: hidden;
      }

      .user-name {
        font-weight: var(--font-medium);
        font-size: var(--text-sm);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .user-email {
        font-size: var(--text-xs);
        color: rgba(255, 255, 255, 0.7);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .settings-btn {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        width: 100%;
        padding: var(--spacing-md);
        background-color: rgba(255, 255, 255, 0.1);
        border: none;
        border-radius: var(--radius);
        color: #fff;
        font-size: var(--text-sm);
        transition: background-color var(--transition-fast);
      }

      .settings-btn:hover {
        background-color: rgba(255, 255, 255, 0.15);
      }

      /* Main Content */
      .main-content {
        flex: 1;
        margin-left: var(--sidebar-width);
        padding: var(--spacing-xl);
        transition: margin-left var(--transition);
      }

      /* Section Styles */
      .section {
        display: none;
      }

      .section.active {
        display: block;
        animation: fadeIn var(--transition-fast);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-xl);
      }

      .section-header h2 {
        font-size: var(--text-2xl);
        font-weight: var(--font-semibold);
      }

      .section-header h3 {
        font-size: var(--text-xl);
        font-weight: var(--font-medium);
      }

      /* Date Selector */
      .date-selector {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        background-color: var(--bg-primary);
        border-radius: var(--radius);
        padding: var(--spacing-sm);
        box-shadow: var(--shadow-sm);
      }

      .date-nav {
        background: transparent;
        border: none;
        width: 32px;
        height: 32px;
        border-radius: var(--radius-full);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-primary);
        transition: background-color var(--transition-fast);
      }

      .date-nav:hover {
        background-color: var(--bg-tertiary);
      }

      .current-date {
        font-weight: var(--font-medium);
        padding: 0 var(--spacing-md);
        min-width: 120px;
        text-align: center;
      }

      /* Budget Summary */
      .budget-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-xl);
      }

      .summary-card {
        background-color: var(--bg-primary);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow);
        display: flex;
        align-items: center;
        gap: var(--spacing-lg);
        transition: transform var(--transition-fast),
          box-shadow var(--transition-fast);
      }

      .summary-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-md);
      }

      .card-icon {
        width: 48px;
        height: 48px;
        border-radius: var(--radius);
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .total-budget .card-icon {
        background-color: rgba(99, 102, 241, 0.1);
        color: var(--primary-color);
      }

      .total-income .card-icon {
        background-color: rgba(16, 185, 129, 0.1);
        color: var(--income-color);
      }

      .total-expenses .card-icon {
        background-color: rgba(239, 68, 68, 0.1);
        color: var(--expense-color);
      }

      .savings-rate .card-icon {
        background-color: rgba(59, 130, 246, 0.1);
        color: var(--info-color);
      }

      .card-content {
        flex: 1;
      }

      .card-content h3 {
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        color: var(--text-secondary);
        margin-bottom: var(--spacing-xs);
      }

      .amount {
        font-size: var(--text-2xl);
        font-weight: var(--font-bold);
        margin-bottom: var(--spacing-xs);
      }

      .trend {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        font-size: var(--text-xs);
        font-weight: var(--font-medium);
      }

      .trend.positive {
        color: var(--success-color);
      }

      .trend.negative {
        color: var(--danger-color);
      }

      /* Charts Section */
      .charts-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: var(--spacing-xl);
        margin-bottom: var(--spacing-xl);
      }

      .chart-container {
        background-color: var(--bg-primary);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow);
      }

      .chart-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-lg);
      }

      .chart-header h3 {
        font-size: var(--text-lg);
        font-weight: var(--font-medium);
      }

      .chart-controls {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .chart-controls select {
        padding: var(--spacing-sm) var(--spacing-md);
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        background-color: var(--bg-primary);
        color: var(--text-primary);
        font-size: var(--text-sm);
      }

      .chart-type-btn {
        padding: var(--spacing-sm) var(--spacing-md);
        border: 1px solid var(--border-color);
        background-color: var(--bg-primary);
        color: var(--text-primary);
        font-size: var(--text-sm);
        border-radius: var(--radius);
        transition: background-color var(--transition-fast),
          color var(--transition-fast);
      }

      .chart-type-btn:hover {
        background-color: var(--bg-tertiary);
      }

      .chart-type-btn.active {
        background-color: var(--primary-color);
        color: #fff;
        border-color: var(--primary-color);
      }

      .chart-body {
        height: 300px;
        position: relative;
      }

      /* Recent Transactions */
      .recent-transactions {
        background-color: var(--bg-primary);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow);
        margin-bottom: var(--spacing-xl);
      }

      .view-all {
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
      }

      .transactions-list {
        margin-top: var(--spacing-md);
      }

      /* Transactions Table */
      .transactions-table-container {
        background-color: var(--bg-primary);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow);
        overflow: hidden;
        margin-bottom: var(--spacing-xl);
      }

      .transactions-table {
        width: 100%;
        border-collapse: collapse;
      }

      .transactions-table th,
      .transactions-table td {
        padding: var(--spacing-md);
        text-align: left;
        border-bottom: 1px solid var(--border-color);
      }

      .transactions-table th {
        background-color: var(--bg-tertiary);
        font-weight: var(--font-medium);
        color: var(--text-secondary);
        font-size: var(--text-sm);
      }

      .th-content {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .sort-btn {
        background: transparent;
        border: none;
        color: var(--text-muted);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .sort-btn:hover {
        color: var(--text-primary);
      }

      /* Filter Bar */
      .filter-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-lg);
        flex-wrap: wrap;
        gap: var(--spacing-md);
      }

      .search-container {
        position: relative;
        flex: 1;
        max-width: 300px;
      }

      .search-container svg {
        position: absolute;
        left: var(--spacing-md);
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-muted);
      }

      .search-container input {
        width: 100%;
        padding: var(--spacing-md) var(--spacing-md) var(--spacing-md)
          calc(var(--spacing-md) * 3);
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        background-color: var(--bg-primary);
        color: var(--text-primary);
      }

      .filter-group {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        flex-wrap: wrap;
      }

      .filter-group select {
        padding: var(--spacing-sm) var(--spacing-md);
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        background-color: var(--bg-primary);
        color: var(--text-primary);
        font-size: var(--text-sm);
      }

      #clear-filters {
        padding: var(--spacing-sm) var(--spacing-md);
        background-color: var(--bg-tertiary);
        border: none;
        border-radius: var(--radius);
        color: var(--text-primary);
        font-size: var(--text-sm);
        transition: background-color var(--transition-fast);
      }

      #clear-filters:hover {
        background-color: var(--border-color);
      }

      /* Pagination */
      .pagination {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--spacing-md);
        margin-top: var(--spacing-xl);
      }

      .pagination-btn {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm) var(--spacing-md);
        background-color: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        color: var(--text-primary);
        font-size: var(--text-sm);
        transition: background-color var(--transition-fast);
      }

      .pagination-btn:hover:not(:disabled) {
        background-color: var(--bg-tertiary);
      }

      .pagination-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .pagination-info {
        font-size: var(--text-sm);
        color: var(--text-secondary);
      }

      /* Empty State */
      .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-2xl);
        color: var(--text-muted);
        text-align: center;
      }

      .empty-state svg {
        margin-bottom: var(--spacing-md);
        opacity: 0.5;
      }

      .empty-state p {
        margin-bottom: var(--spacing-lg);
        font-size: var(--text-lg);
      }

      /* Buttons */
      .add-transaction-btn,
      .add-budget-btn,
      .add-goal-btn,
      .export-btn,
      .generate-report-btn {
        padding: var(--spacing-sm) var(--spacing-lg);
        background-color: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: var(--radius);
        font-weight: var(--font-medium);
        font-size: var(--text-sm);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        transition: background-color var(--transition-fast);
      }

      .add-transaction-btn:hover,
      .add-budget-btn:hover,
      .add-goal-btn:hover,
      .export-btn:hover,
      .generate-report-btn:hover {
        background-color: var(--primary-hover);
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 100;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(4px);
      }

      .modal.active {
        display: flex;
        animation: fadeIn var(--transition-fast);
      }

      .modal-content {
        background-color: var(--bg-primary);
        border-radius: var(--radius-lg);
        width: 90%;
        max-width: 500px;
        box-shadow: var(--shadow-lg);
        max-height: 90vh;
        overflow-y: auto;
      }

      .modal-header {
        padding: var(--spacing-lg);
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .modal-header h3 {
        font-size: var(--text-xl);
        font-weight: var(--font-semibold);
      }

      .close-modal {
        background: transparent;
        border: none;
        color: var(--text-muted);
        display: flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        border-radius: var(--radius-full);
        transition: background-color var(--transition-fast),
          color var(--transition-fast);
      }

      .close-modal:hover {
        background-color: var(--bg-tertiary);
        color: var(--text-primary);
      }

      .modal-body {
        padding: var(--spacing-lg);
      }

      /* Forms */
      .form-group {
        margin-bottom: var(--spacing-lg);
      }

      .form-group label {
        display: block;
        margin-bottom: var(--spacing-sm);
        font-weight: var(--font-medium);
        font-size: var(--text-sm);
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: var(--spacing-md);
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        background-color: var(--bg-primary);
        color: var(--text-primary);
        font-size: var(--text-base);
      }

      .form-group textarea {
        min-height: 100px;
        resize: vertical;
      }

      .transaction-type-toggle {
        display: flex;
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        overflow: hidden;
      }

      .transaction-type-toggle input {
        display: none;
      }

      .transaction-type-toggle label {
        flex: 1;
        padding: var(--spacing-md);
        text-align: center;
        margin: 0;
        cursor: pointer;
        transition: background-color var(--transition-fast),
          color var(--transition-fast);
      }

      .transaction-type-toggle input:checked + label {
        background-color: var(--primary-color);
        color: #fff;
      }

      .transaction-type-toggle input[value="inc"]:checked + label {
        background-color: var(--income-color);
      }

      .transaction-type-toggle input[value="exp"]:checked + label {
        background-color: var(--expense-color);
      }

      .amount-input {
        position: relative;
      }

      .currency-symbol {
        position: absolute;
        left: var(--spacing-md);
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-secondary);
      }

      .amount-input input {
        padding-left: calc(var(--spacing-md) * 2);
      }

      .category-select-container {
        display: flex;
        gap: var(--spacing-sm);
      }

      .category-select-container select {
        flex: 1;
      }

      #add-category-btn {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--bg-tertiary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        color: var(--text-primary);
        transition: background-color var(--transition-fast);
      }

      #add-category-btn:hover {
        background-color: var(--border-color);
      }

      .color-options {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-md);
        margin-top: var(--spacing-sm);
      }

      .color-option {
        width: 36px;
        height: 36px;
        border-radius: var(--radius-full);
        cursor: pointer;
        transition: transform var(--transition-fast),
          box-shadow var(--transition-fast);
        border: 2px solid transparent;
      }

      .color-option:hover {
        transform: scale(1.1);
      }

      .color-option.selected {
        border-color: var(--text-primary);
        box-shadow: 0 0 0 2px var(--bg-primary), 0 0 0 4px var(--border-color);
      }

      .form-actions {
        display: flex;
        justify-content: flex-end;
        gap: var(--spacing-md);
        margin-top: var(--spacing-xl);
      }

      .cancel-btn {
        padding: var(--spacing-md) var(--spacing-lg);
        background-color: var(--bg-tertiary);
        border: none;
        border-radius: var(--radius);
        color: var(--text-primary);
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        transition: background-color var(--transition-fast);
      }

      .cancel-btn:hover {
        background-color: var(--border-color);
      }

      .save-btn {
        padding: var(--spacing-md) var(--spacing-lg);
        background-color: var(--primary-color);
        border: none;
        border-radius: var(--radius);
        color: #fff;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        transition: background-color var(--transition-fast);
      }

      .save-btn:hover {
        background-color: var(--primary-hover);
      }

      /* Report Styles */
      .report-filters {
        background-color: var(--bg-tertiary);
        padding: var(--spacing-lg);
        border-radius: var(--radius);
        margin-bottom: var(--spacing-xl);
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: var(--spacing-md);
      }

      .date-range-picker {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
      }

      .date-range-picker label {
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
      }

      .date-inputs {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .date-inputs input {
        padding: var(--spacing-sm) var(--spacing-md);
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        background-color: var(--bg-primary);
        color: var(--text-primary);
      }

      .report-content {
        background-color: var(--bg-primary);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow);
        min-height: 400px;
      }

      /* Account Management Styles */
      .accounts-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-xl);
      }

      .account-card {
        background-color: var(--bg-primary);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow);
        transition: transform var(--transition-fast),
          box-shadow var(--transition-fast);
      }

      .account-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-md);
      }

      .account-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-md);
      }

      .account-header h3 {
        font-size: var(--text-lg);
        font-weight: var(--font-medium);
      }

      .account-type {
        padding: 2px 8px;
        border-radius: var(--radius-full);
        font-size: var(--text-xs);
        color: white;
        background-color: var(--primary-color);
      }

      .account-balance {
        font-size: var(--text-2xl);
        font-weight: var(--font-bold);
        margin-bottom: var(--spacing-md);
      }

      .account-details {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-xs);
        margin-bottom: var(--spacing-md);
        font-size: var(--text-sm);
        color: var(--text-secondary);
      }

      .account-actions {
        display: flex;
        gap: var(--spacing-sm);
      }

      .account-btn {
        flex: 1;
        padding: var(--spacing-sm);
        border-radius: var(--radius);
        font-size: var(--text-sm);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--spacing-xs);
        transition: background-color var(--transition-fast);
        border: none;
      }

      .edit-account-btn {
        background-color: var(--bg-tertiary);
        color: var(--text-primary);
      }

      .edit-account-btn:hover {
        background-color: var(--border-color);
      }

      .delete-account-btn {
        background-color: rgba(239, 68, 68, 0.1);
        color: var(--danger-color);
      }

      .delete-account-btn:hover {
        background-color: rgba(239, 68, 68, 0.2);
      }

      /* Responsive Styles */
      @media (max-width: 1024px) {
        .charts-section {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.active {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
        }

        .budget-summary {
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }

        .filter-bar {
          flex-direction: column;
          align-items: flex-start;
        }

        .search-container {
          max-width: 100%;
          width: 100%;
        }

        .filter-group {
          width: 100%;
          justify-content: space-between;
        }

        .filter-group select {
          flex: 1;
        }
      }

      @media (max-width: 480px) {
        .budget-summary {
          grid-template-columns: 1fr;
        }

        .form-actions {
          flex-direction: column;
        }

        .cancel-btn,
        .save-btn {
          width: 100%;
        }
      }
      /* Profile Styles */
      .avatar-selector {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
      }

      .avatar-preview {
        width: 80px;
        height: 80px;
        border-radius: var(--radius-full);
        overflow: hidden;
        border: 2px solid var(--border-color);
      }

      .avatar-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .avatar-options {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-sm);
      }

      .avatar-option {
        width: 40px;
        height: 40px;
        border-radius: var(--radius-full);
        overflow: hidden;
        border: 2px solid var(--border-color);
        padding: 0;
        background: none;
        cursor: pointer;
        transition: border-color var(--transition-fast);
      }

      .avatar-option:hover {
        border-color: var(--primary-color);
      }

      .avatar-option.selected {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px var(--primary-color);
      }

      .avatar-option img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      /* Profile Switcher */
      .profiles-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
        max-height: 400px;
        overflow-y: auto;
      }

      .profile-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        padding: var(--spacing-md);
        border-radius: var(--radius);
        background-color: var(--bg-tertiary);
        cursor: pointer;
        transition: background-color var(--transition-fast);
      }

      .profile-item:hover {
        background-color: var(--border-color);
      }

      .profile-item.active {
        background-color: rgba(99, 102, 241, 0.1);
        border: 1px solid var(--primary-color);
      }

      .profile-item-avatar {
        width: 50px;
        height: 50px;
        border-radius: var(--radius-full);
        overflow: hidden;
        flex-shrink: 0;
      }

      .profile-item-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .profile-item-info {
        flex: 1;
      }

      .profile-item-name {
        font-weight: var(--font-medium);
        margin-bottom: var(--spacing-xs);
      }

      .profile-item-email {
        font-size: var(--text-sm);
        color: var(--text-secondary);
      }

      .profile-item-actions {
        display: flex;
        gap: var(--spacing-sm);
      }

      .profile-action-btn {
        background: transparent;
        border: none;
        width: 32px;
        height: 32px;
        border-radius: var(--radius);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-secondary);
        transition: background-color var(--transition-fast),
          color var(--transition-fast);
      }

      .profile-action-btn:hover {
        background-color: var(--bg-tertiary);
      }

      .profile-action-btn.edit:hover {
        color: var(--primary-color);
      }

      .profile-action-btn.delete:hover {
        color: var(--danger-color);
      }

      /* User Menu in Sidebar */
      .user-menu {
        position: relative;
      }

      .user-menu-dropdown {
        position: absolute;
        bottom: 100%;
        left: 0;
        width: 100%;
        background-color: var(--bg-sidebar);
        border-radius: var(--radius);
        box-shadow: var(--shadow-lg);
        padding: var(--spacing-md);
        display: none;
        z-index: 10;
      }

      .user-menu-dropdown.active {
        display: block;
        animation: fadeIn var(--transition-fast);
      }

      .user-menu-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        padding: var(--spacing-md);
        color: rgba(255, 255, 255, 0.7);
        border-radius: var(--radius);
        cursor: pointer;
        transition: background-color var(--transition-fast),
          color var(--transition-fast);
      }

      .user-menu-item:hover {
        background-color: rgba(255, 255, 255, 0.05);
        color: #fff;
      }

      .user-menu-item svg {
        width: 18px;
        height: 18px;
      }
      /* Footer Styles */
      .site-footer {
        background-color: var(--bg-sidebar);
        color: white;
        padding: var(--spacing-lg) 0;
        margin-top: auto;
      }

      .footer-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 var(--spacing-lg);
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
      }

      .footer-logo {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-weight: 600;
        margin-bottom: var(--spacing-md);
      }

      .footer-logo svg {
        color: var(--primary-color);
      }

      .footer-copyright {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.875rem;
        margin-bottom: var(--spacing-md);
      }

      .footer-social {
        display: flex;
        gap: var(--spacing-md);
      }

      .social-link {
        color: rgba(255, 255, 255, 0.7);
        transition: color 0.3s;
      }

      .social-link:hover {
        color: var(--primary-color);
      }

      @media (max-width: 768px) {
        .footer-container {
          flex-direction: column;
          text-align: center;
        }

        .footer-logo {
          justify-content: center;
        }

        .footer-social {
          justify-content: center;
        }
      }
      /* Login and Signup Styles */
      .login-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        padding: 1rem;
        background-color: var(--bg-secondary);
      }

      .login-card {
        background-color: var(--bg-primary);
        border-radius: 0.75rem;
        box-shadow: var(--shadow-lg);
        width: 100%;
        max-width: 400px;
        padding: 2rem;
      }

      .login-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .logo {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
      }

      .logo h1 {
        font-size: 1.5rem;
        font-weight: 700;
        margin-left: 0.5rem;
      }

      .logo span {
        color: var(--primary-color);
      }

      .login-header h2 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .login-header p {
        color: var(--text-secondary);
        font-size: 0.875rem;
      }

      #google-signin-button {
        display: flex;
        justify-content: center;
        margin-bottom: 1.5rem;
      }

      .divider {
        position: relative;
        text-align: center;
        margin: 1.5rem 0;
      }

      .divider::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 1px;
        background-color: var(--border-color);
      }

      .divider span {
        position: relative;
        background-color: var(--bg-primary);
        padding: 0 1rem;
        color: var(--text-secondary);
        font-size: 0.875rem;
      }

      .form-group {
        margin-bottom: 1rem;
      }

      .form-group label {
        display: block;
        margin-bottom: 0.25rem;
        font-weight: 500;
        font-size: 0.875rem;
      }

      .form-group input {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--border-color);
        border-radius: 0.375rem;
        background-color: var(--bg-primary);
        color: var(--text-primary);
        font-size: 1rem;
      }

      .form-group input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
      }

      .login-btn {
        width: 100%;
        padding: 0.75rem;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 0.375rem;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.3s;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .login-btn:hover {
        background-color: var(--primary-hover);
      }

      .login-btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
      }

      .spinner {
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top: 2px solid white;
        width: 16px;
        height: 16px;
        margin-right: 0.5rem;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .login-footer {
        text-align: center;
        margin-top: 1.5rem;
        font-size: 0.875rem;
        color: var(--text-secondary);
      }

      .login-footer a {
        color: var(--primary-color);
        text-decoration: none;
      }

      .login-footer a:hover {
        text-decoration: underline;
      }

      /* Footer Styles */
      .site-footer {
        background-color: var(--bg-sidebar);
        color: white;
        padding: 1.5rem 0;
        margin-top: auto;
      }

      .footer-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1.5rem;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
      }

      .footer-logo {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .footer-logo svg {
        color: var(--primary-color);
      }

      .footer-copyright {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.875rem;
        margin-bottom: 1rem;
      }

      .footer-social {
        display: flex;
        gap: 1rem;
      }

      .social-link {
        color: rgba(255, 255, 255, 0.7);
        transition: color 0.3s;
      }

      .social-link:hover {
        color: var(--primary-color);
      }

      @media (max-width: 768px) {
        .footer-container {
          flex-direction: column;
          text-align: center;
        }

        .footer-logo {
          justify-content: center;
        }

        .footer-social {
          justify-content: center;
        }
      }
      .menu-toggle {
        display: none;
        font-size: 1.5rem;
        background: none;
        border: none;
        color: white;
        cursor: pointer;
      }

      @media (max-width: 768px) {
        .menu-toggle {
          display: block;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="logo">
            <svg
              width="32"
              height="32"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13.41 18.09V20H10.74V18.07C9.03 17.71 7.58 16.61 7.47 14.67H9.43C9.53 15.72 10.25 16.54 12.08 16.54C14.04 16.54 14.48 15.56 14.48 14.95C14.48 14.12 14.04 13.34 11.81 12.81C9.33 12.21 7.63 11.19 7.63 9.14C7.63 7.42 9.02 6.23 10.74 5.92V4H13.41V5.92C15.27 6.31 16.2 7.79 16.26 9.22H14.3C14.25 8.2 13.66 7.4 12.08 7.4C10.58 7.4 9.68 8.13 9.68 9.05C9.68 9.96 10.39 10.5 12.3 11.02C14.21 11.54 16.53 12.41 16.53 14.93C16.53 16.71 15.19 17.76 13.41 18.09Z"
                fill="currentColor"
              />
            </svg>
            <h1>Budgety<span>Pro</span></h1>
          </div>
          <button class="theme-toggle" id="theme-toggle">
            <svg
              class="sun-icon"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17Z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M12 1V3"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M12 21V23"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M4.22 4.22L5.64 5.64"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M18.36 18.36L19.78 19.78"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M1 12H3"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M21 12H23"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M4.22 19.78L5.64 18.36"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M18.36 5.64L19.78 4.22"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <svg
              class="moon-icon"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M21 12.79C20.8427 14.4922 20.2039 16.1144 19.1582 17.4668C18.1126 18.8192 16.7035 19.8458 15.0957 20.4265C13.4879 21.0073 11.748 21.1181 10.0795 20.7461C8.41104 20.3741 6.88302 19.5345 5.67425 18.3258C4.46548 17.117 3.62596 15.589 3.25393 13.9205C2.8819 12.252 2.99274 10.5121 3.57348 8.9043C4.15423 7.29651 5.18085 5.88737 6.53324 4.84175C7.88562 3.79614 9.50782 3.15731 11.21 3C10.2134 4.34827 9.73385 6.00945 9.85853 7.68141C9.98322 9.35338 10.7039 10.9251 11.8894 12.1106C13.0749 13.2961 14.6466 14.0168 16.3186 14.1415C17.9906 14.2662 19.6517 13.7866 21 12.79Z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>
        <nav class="sidebar-nav">
          <button id="menu-toggle" class="menu-toggle">☰</button>
          <ul>
            <li class="active" data-section="dashboard">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M9 22V12H15V22"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span>Dashboard</span>
            </li>
            <li data-section="accounts">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21 4H3C1.89543 4 1 4.89543 1 6V18C1 19.1046 1.89543 20 3 20H21C22.1046 20 23 19.1046 23 18V6C23 4.89543 22.1046 4 21 4Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M1 10H23"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span>Accounts</span>
            </li>
            <li data-section="transactions">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19 5H5C3.89543 5 3 5.89543 3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V7C21 5.89543 20.1046 5 19 5Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M3 7L12 13L21 7"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span>Transactions</span>
            </li>
            <li data-section="budget">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21 4H3C1.89543 4 1 4.89543 1 6V18C1 19.1046 1.89543 20 3 20H21C22.1046 20 23 19.1046 23 18V6C23 4.89543 22.1046 4 21 4Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M1 10H23"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span>Budget</span>
            </li>
            <li data-section="goals">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M12 10C13.1046 10 14 10.8954 14 12C14 13.1046 13.1046 14 12 14C10.8954 14 10 13.1046 10 12C10 10.8954 10.8954 10 12 10Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span>Goals</span>
            </li>
            <li data-section="reports">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18 20V10"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M12 20V4"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M6 20V14"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span>Reports</span>
            </li>

            <li data-section="MarketPro">
              <div class="logo">
                <i class="fas fa-chart-line"></i>
                <a href="index2.html">MarketPro</a>
              </div>
            </li>
          </ul>
        </nav>
        
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
          <div class="section-header">
            <h2>Dashboard</h2>
            <div class="date-selector">
              <button class="date-nav prev">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M15 18L9 12L15 6"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
              <div class="current-date" id="current-date">March 2025</div>
              <button class="date-nav next">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M9 18L15 12L9 6"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
            </div>
          </div>

          <!-- Budget Summary -->
          <div class="budget-summary">
            <div class="summary-card total-budget">
              <div class="card-icon">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M12 1V23"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M17 5H9.5C8.57174 5 7.6815 5.36875 7.02513 6.02513C6.36875 6.6815 6 7.57174 6 8.5C6 9.42826 6.36875 10.3185 7.02513 10.9749C7.6815 11.6313 8.57174 12 9.5 12H14.5C15.4283 12 16.3185 12.3687 16.9749 13.0251C17.6313 13.6815 18 14.5717 18 15.5C18 16.4283 17.6313 17.3185 16.9749 17.9749C16.3185 18.6313 15.4283 19 14.5 19H6"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <div class="card-content">
                <h3>Total Budget</h3>
                <p class="amount" id="total-budget">₹0.00</p>
                <div class="trend positive">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M18 15L12 9L6 15"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  <span>0%</span>
                </div>
              </div>
            </div>
            <div class="summary-card total-income">
              <div class="card-icon">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M12 22V2"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M5 12H19"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M5 5H19"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M5 19H19"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <div class="card-content">
                <h3>Total Income</h3>
                <p class="amount" id="total-income">₹0.00</p>
                <div class="trend positive">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M18 15L12 9L6 15"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  <span>0%</span>
                </div>
              </div>
            </div>
            <div class="summary-card total-expenses">
              <div class="card-icon">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M12 22V2"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M17 17L12 12L7 17"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M5 12H19"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <div class="card-content">
                <h3>Total Expenses</h3>
                <p class="amount" id="total-expenses">₹0.00</p>
                <div class="trend negative">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M6 9L12 15L18 9"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  <span>0%</span>
                </div>
              </div>
            </div>
            <div class="summary-card savings-rate">
              <div class="card-icon">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M19 21L12 16L5 21V5C5 4.46957 5.21071 3.96086 5.58579 3.58579C5.96086 3.21071 6.46957 3 7 3H17C17.5304 3 18.0391 3.21071 18.4142 3.58579C18.7893 3.96086 19 4.46957 19 5V21Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <div class="card-content">
                <h3>Savings Rate</h3>
                <p class="amount" id="savings-rate">0%</p>
                <div class="trend positive">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M18 15L12 9L6 15"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  <span>0%</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Charts Section -->
          <div class="charts-section">
            <div class="chart-container">
              <div class="chart-header">
                <h3>Income vs Expenses</h3>
                <div class="chart-controls">
                  <select id="chart-period">
                    <option value="week">This Week</option>
                    <option value="month" selected>This Month</option>
                    <option value="year">This Year</option>
                  </select>
                </div>
              </div>
              <div class="chart-body">
                <canvas id="income-expense-chart"></canvas>
              </div>
            </div>
            <div class="chart-container">
              <div class="chart-header">
                <h3>Expense Categories</h3>
                <div class="chart-controls">
                  <button class="chart-type-btn active" data-type="pie">
                    Pie
                  </button>
                  <button class="chart-type-btn" data-type="doughnut">
                    Doughnut
                  </button>
                </div>
              </div>
              <div class="chart-body">
                <canvas id="expense-categories-chart"></canvas>
              </div>
            </div>
          </div>

          <!-- Recent Transactions -->
          <div class="recent-transactions">
            <div class="section-header">
              <h3>Recent Transactions</h3>
              <a href="#" class="view-all">View All</a>
            </div>
            <div class="transactions-list" id="recent-transactions-list">
              <!-- Transactions will be added here dynamically -->
              <div class="empty-state">
                <svg
                  width="64"
                  height="64"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M19 5H5C3.89543 5 3 5.89543 3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V7C21 5.89543 20.1046 5 19 5Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M3 7L12 13L21 7"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <p>No transactions yet</p>
                <button class="add-transaction-btn">Add Transaction</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Accounts Section -->
        <section id="accounts" class="section">
          <div class="section-header">
            <h2>Accounts</h2>
            <button class="add-transaction-btn" id="add-account-btn">
              Add Account
            </button>
          </div>

          <div class="accounts-container" id="accounts-container">
            <!-- Accounts will be added here dynamically -->
            <div class="empty-state">
              <svg
                width="64"
                height="64"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21 4H3C1.89543 4 1 4.89543 1 6V18C1 19.1046 1.89543 20 3 20H21C22.1046 20 23 19.1046 23 18V6C23 4.89543 22.1046 4 21 4Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M1 10H23"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <p>No accounts added yet</p>
              <button class="add-transaction-btn" id="add-first-account-btn">
                Add Account
              </button>
            </div>
          </div>
        </section>

        <!-- Transactions Section -->
        <section id="transactions" class="section">
          <div class="section-header">
            <h2>Transactions</h2>
            <button class="add-transaction-btn">Add Transaction</button>
          </div>
          <button id="export-excel" class="export-btn">
            Export Bank Statement (Excel)
          </button>

          <div class="filter-bar">
            <div class="search-container">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M21 21L16.65 16.65"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <input
                type="text"
                placeholder="Search transactions..."
                id="transaction-search"
              />
            </div>
            <div class="filter-group">
              <select id="transaction-type-filter">
                <option value="all">All Types</option>
                <option value="inc">Income</option>
                <option value="exp">Expense</option>
              </select>
              <select id="transaction-category-filter">
                <option value="all">All Categories</option>
                <!-- Categories will be added dynamically -->
              </select>
              <select id="transaction-date-filter">
                <option value="all">All Time</option>
                <option value="today">Today</option>
                <option value="week">This Week</option>
                <option value="month">This Month</option>
                <option value="year">This Year</option>
              </select>
              <button id="clear-filters">Clear Filters</button>
            </div>
          </div>

          <div class="transactions-table-container">
            <table class="transactions-table">
              <thead>
                <tr>
                  <th>
                    <div class="th-content">
                      <span>Date</span>
                      <button class="sort-btn" data-sort="date">
                        <svg
                          width="16"
                          height="16"
                          viewBox="0 0 24 24"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M7 15L12 20L17 15"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <path
                            d="M7 9L12 4L17 9"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                    </div>
                  </th>
                  <th>
                    <div class="th-content">
                      <span>Description</span>
                      <button class="sort-btn" data-sort="description">
                        <svg
                          width="16"
                          height="16"
                          viewBox="0 0 24 24"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M7 15L12 20L17 15"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <path
                            d="M7 9L12 4L17 9"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                    </div>
                  </th>
                  <th>
                    <div class="th-content">
                      <span>Category</span>
                      <button class="sort-btn" data-sort="category">
                        <svg
                          width="16"
                          height="16"
                          viewBox="0 0 24 24"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M7 15L12 20L17 15"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <path
                            d="M7 9L12 4L17 9"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                    </div>
                  </th>
                  <th>
                    <div class="th-content">
                      <span>Amount</span>
                      <button class="sort-btn" data-sort="amount">
                        <svg
                          width="16"
                          height="16"
                          viewBox="0 0 24 24"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M7 15L12 20L17 15"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <path
                            d="M7 9L12 4L17 9"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                    </div>
                  </th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="transactions-table-body">
                <!-- Transactions will be added here dynamically -->
              </tbody>
            </table>
            <div class="empty-state" id="transactions-empty-state">
              <svg
                width="64"
                height="64"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19 5H5C3.89543 5 3 5.89543 3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V7C21 5.89543 20.1046 5 19 5Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M3 7L12 13L21 7"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <p>No transactions found</p>
              <button class="add-transaction-btn">Add Transaction</button>
            </div>
          </div>

          <div class="pagination">
            <button class="pagination-btn prev" disabled>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M15 18L9 12L15 6"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              Previous
            </button>
            <div class="pagination-info">
              Page <span id="current-page">1</span> of
              <span id="total-pages">1</span>
            </div>
            <button class="pagination-btn next" disabled>
              Next
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9 18L15 12L9 6"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
        </section>

        <!-- Budget Section -->
        <section id="budget" class="section">
          <div class="section-header">
            <h2>Budget Planning</h2>
            <button class="add-budget-btn">Create Budget</button>
          </div>

          <div class="budget-overview">
            <div class="budget-progress-cards">
              <!-- Budget progress cards will be added here dynamically -->
              <div class="empty-state">
                <svg
                  width="64"
                  height="64"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M21 4H3C1.89543 4 1 4.89543 1 6V18C1 19.1046 1.89543 20 3 20H21C22.1046 20 23 19.1046 23 18V6C23 4.89543 22.1046 4 21 4Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M1 10H23"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <p>No budgets created yet</p>
                <button class="add-budget-btn">Create Budget</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Goals Section -->
        <section id="goals" class="section">
          <div class="section-header">
            <h2>Financial Goals</h2>
            <button class="add-goal-btn">Add Goal</button>
          </div>

          <div class="goals-container">
            <!-- Goals will be added here dynamically -->
            <div class="empty-state">
              <svg
                width="64"
                height="64"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M12 10C13.1046 10 14 10.8954 14 12C14 13.1046 13.1046 14 12 14C10.8954 14 10 13.1046 10 12C10 10.8954 10.8954 10 12 10Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <p>No goals created yet</p>
              <button class="add-goal-btn">Add Goal</button>
            </div>
          </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="section">
          <div class="section-header">
            <h2>Financial Reports</h2>
            <div class="report-controls">
              <select id="report-type">
                <option value="monthly">Monthly Report</option>
                <option value="category">Category Report</option>
                <option value="trend">Trend Analysis</option>
              </select>
              <button class="export-btn">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M7 10L12 15L17 10"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M12 15V3"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                Export
              </button>
            </div>
          </div>

          <div class="report-container">
            <div class="report-filters">
              <div class="date-range-picker">
                <label>Date Range</label>
                <div class="date-inputs">
                  <input type="date" id="report-start-date" />
                  <span>to</span>
                  <input type="date" id="report-end-date" />
                </div>
              </div>
              <button class="generate-report-btn">Generate Report</button>
            </div>

            <div class="report-content">
              <!-- Report content will be added here dynamically -->
              <div class="empty-state">
                <svg
                  width="64"
                  height="64"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M18 20V10"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M12 20V4"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M6 20V14"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <p>Select date range and generate report</p>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- Modals -->
      <div class="modal" id="transaction-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Add Transaction</h3>
            <button class="close-modal">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18 6L6 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M6 6L18 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          <div class="modal-body">
            <form id="transaction-form">
              <div class="form-group">
                <label for="transaction-type">Type</label>
                <div class="transaction-type-toggle">
                  <input
                    type="radio"
                    id="income-type"
                    name="transaction-type"
                    value="inc"
                    checked
                  />
                  <label for="income-type">Income</label>
                  <input
                    type="radio"
                    id="expense-type"
                    name="transaction-type"
                    value="exp"
                  />
                  <label for="expense-type">Expense</label>
                </div>
              </div>
              <div class="form-group">
                <label for="transaction-amount">Amount</label>
                <div class="amount-input">
                  <span class="currency-symbol">₹</span>
                  <input
                    type="number"
                    id="transaction-amount"
                    step="0.01"
                    min="0.01"
                    required
                  />
                </div>
              </div>
              <div class="form-group">
                <label for="transaction-description">Description</label>
                <input type="text" id="transaction-description" required />
              </div>
              <div class="form-group">
                <label for="transaction-category">Category</label>
                <div class="category-select-container">
                  <select id="transaction-category" required>
                    <!-- Categories will be added dynamically -->
                  </select>
                  <button type="button" id="add-category-btn">
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M12 5V19"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                      <path
                        d="M5 12H19"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </button>
                </div>
              </div>
              <div class="form-group">
                <label for="transaction-account">Account</label>
                <select id="transaction-account" required>
                  <!-- Accounts will be added dynamically -->
                </select>
              </div>
              <div class="form-group">
                <label for="transaction-date">Date</label>
                <input type="date" id="transaction-date" required />
              </div>
              <div class="form-group">
                <label for="transaction-notes">Notes (Optional)</label>
                <textarea id="transaction-notes"></textarea>
              </div>
              <div class="form-actions">
                <button type="button" class="cancel-btn">Cancel</button>
                <button type="submit" class="save-btn">Save Transaction</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="modal" id="category-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Add Category</h3>
            <button class="close-modal">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18 6L6 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M6 6L18 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          <div class="modal-body">
            <form id="category-form">
              <input type="hidden" id="category-type" value="exp" />
              <div class="form-group">
                <label for="category-name">Category Name</label>
                <input type="text" id="category-name" required />
              </div>
              <div class="form-group">
                <label>Color</label>
                <div class="color-options">
                  <div
                    class="color-option"
                    data-color="#FF5049"
                    style="background-color: #ff5049"
                  ></div>
                  <div
                    class="color-option"
                    data-color="#28B9B5"
                    style="background-color: #28b9b5"
                  ></div>
                  <div
                    class="color-option"
                    data-color="#FFBB00"
                    style="background-color: #ffbb00"
                  ></div>
                  <div
                    class="color-option"
                    data-color="#6666FF"
                    style="background-color: #6666ff"
                  ></div>
                  <div
                    class="color-option"
                    data-color="#66CC99"
                    style="background-color: #66cc99"
                  ></div>
                  <div
                    class="color-option"
                    data-color="#FF9999"
                    style="background-color: #ff9999"
                  ></div>
                  <div
                    class="color-option"
                    data-color="#9966FF"
                    style="background-color: #9966ff"
                  ></div>
                  <div
                    class="color-option"
                    data-color="#99CCFF"
                    style="background-color: #99ccff"
                  ></div>
                </div>
                <input type="hidden" id="category-color" required />
              </div>
              <div class="form-group">
                <label for="category-icon">Icon (Optional)</label>
                <select id="category-icon">
                  <option value="default">Default</option>
                  <option value="food">Food</option>
                  <option value="transport">Transport</option>
                  <option value="shopping">Shopping</option>
                  <option value="bills">Bills</option>
                  <option value="entertainment">Entertainment</option>
                  <option value="health">Health</option>
                  <option value="education">Education</option>
                </select>
              </div>
              <div class="form-actions">
                <button type="button" class="cancel-btn">Cancel</button>
                <button type="submit" class="save-btn">Save Category</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Account Modal -->
      <div class="modal" id="account-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Add Account</h3>
            <button class="close-modal">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18 6L6 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M6 6L18 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          <div class="modal-body">
            <form id="account-form">
              <input type="hidden" id="account-id" />
              <div class="form-group">
                <label for="account-name">Account Name</label>
                <input type="text" id="account-name" required />
              </div>
              <div class="form-group">
                <label for="account-type">Account Type</label>
                <select id="account-type" required>
                  <option value="savings">Savings Account</option>
                  <option value="checking">Checking Account</option>
                  <option value="credit">Credit Card</option>
                  <option value="cash">Cash</option>
                  <option value="investment">Investment</option>
                  <option value="loan">Loan</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div class="form-group">
                <label for="account-balance">Current Balance</label>
                <div class="amount-input">
                  <span class="currency-symbol">₹</span>
                  <input
                    type="number"
                    id="account-balance"
                    step="0.01"
                    required
                  />
                </div>
              </div>
              <div class="form-group">
                <label for="account-number">Account Number (Optional)</label>
                <input type="text" id="account-number" />
              </div>
              <div class="form-group">
                <label for="account-notes">Notes (Optional)</label>
                <textarea id="account-notes"></textarea>
              </div>
              <div class="form-actions">
                <button type="button" class="cancel-btn">Cancel</button>
                <button type="submit" class="save-btn">Save Account</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <!-- Profile Modal -->
      <div class="modal" id="profile-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>User Profile</h3>
            <button class="close-modal">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18 6L6 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M6 6L18 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          <div class="modal-body">
            <form id="profile-form">
              <input type="hidden" id="profile-id" />
              <div class="form-group">
                <label for="profile-name">Full Name</label>
                <input type="text" id="profile-name" required />
              </div>
              <div class="form-group">
                <label for="profile-email">Email</label>
                <input type="email" id="profile-email" required />
              </div>
              <div class="form-group">
                <label for="profile-currency">Currency</label>
                <select id="profile-currency" required>
                  <option value="INR">Indian Rupee (₹)</option>
                  <option value="USD">US Dollar ($)</option>
                  <option value="EUR">Euro (€)</option>
                  <option value="GBP">British Pound (£)</option>
                  <option value="JPY">Japanese Yen (¥)</option>
                  <option value="CAD">Canadian Dollar (C$)</option>
                  <option value="AUD">Australian Dollar (A$)</option>
                </select>
              </div>
              <div class="form-group">
                <label for="profile-avatar">Profile Picture</label>
                <div class="avatar-selector">
                  <div class="avatar-preview">
                    <img
                      id="avatar-preview-img"
                      src="/placeholder.svg?height=80&width=80"
                      alt="Avatar Preview"
                    />
                  </div>
                  <div class="avatar-options">
                    <button
                      type="button"
                      class="avatar-option"
                      data-avatar="avatar-1"
                    >
                      <img
                        src="/placeholder.svg?height=40&width=40"
                        alt="Avatar 1"
                      />
                    </button>
                    <button
                      type="button"
                      class="avatar-option"
                      data-avatar="avatar-2"
                    >
                      <img
                        src="/placeholder.svg?height=40&width=40"
                        alt="Avatar 2"
                      />
                    </button>
                    <button
                      type="button"
                      class="avatar-option"
                      data-avatar="avatar-3"
                    >
                      <img
                        src="/placeholder.svg?height=40&width=40"
                        alt="Avatar 3"
                      />
                    </button>
                    <button
                      type="button"
                      class="avatar-option"
                      data-avatar="avatar-4"
                    >
                      <img
                        src="/placeholder.svg?height=40&width=40"
                        alt="Avatar 4"
                      />
                    </button>
                    <button
                      type="button"
                      class="avatar-option"
                      data-avatar="avatar-5"
                    >
                      <img
                        src="/placeholder.svg?height=40&width=40"
                        alt="Avatar 5"
                      />
                    </button>
                    <button
                      type="button"
                      class="avatar-option"
                      data-avatar="avatar-6"
                    >
                      <img
                        src="/placeholder.svg?height=40&width=40"
                        alt="Avatar 6"
                      />
                    </button>
                  </div>
                  <input type="hidden" id="profile-avatar" required />
                </div>
              </div>
              <div class="form-group">
                <label for="profile-start-date"
                  >Financial Tracking Start Date</label
                >
                <input type="date" id="profile-start-date" required />
              </div>
              <div class="form-group">
                <label for="profile-notes">Bio/Notes (Optional)</label>
                <textarea id="profile-notes"></textarea>
              </div>
              <div class="form-actions">
                <button type="button" class="cancel-btn">Cancel</button>
                <button type="submit" class="save-btn">Save Profile</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Profile Switcher Modal -->
      <div class="modal" id="profile-switcher-modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Switch Profile</h3>
            <button class="close-modal">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18 6L6 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M6 6L18 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          <div class="modal-body">
            <div class="profiles-list" id="profiles-list">
              <!-- Profiles will be added here dynamically -->
            </div>
            <div class="form-actions">
              <button
                type="button"
                id="create-new-profile-btn"
                class="save-btn"
              >
                Create New Profile
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer -->
    <footer class="site-footer">
      <div class="footer-container">
        <div class="footer-logo">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13.41 18.09V20H10.74V18.07C9.03 17.71 7.58 16.61 7.47 14.67H9.43C9.53 15.72 10.25 16.54 12.08 16.54C14.04 16.54 14.48 15.56 14.48 14.95C14.48 14.12 14.04 13.34 11.81 12.81C9.33 12.21 7.63 11.19 7.63 9.14C7.63 7.42 9.02 6.23 10.74 5.92V4H13.41V5.92C15.27 6.31 16.2 7.79 16.26 9.22H14.3C14.25 8.2 13.66 7.4 12.08 7.4C10.58 7.4 9.68 8.13 9.68 9.05C9.68 9.96 10.39 10.5 12.3 11.02C14.21 11.54 16.53 12.41 16.53 14.93C16.53 16.71 15.19 17.76 13.41 18.09Z"
              fill="currentColor"
            />
          </svg>
        </div>
        <div class="footer-copyright">
          &copy; 2025 BudgetyPro. All rights reserved by BudgetyPro
        </div>
        <div class="footer-social">
          <a href="#" class="social-link">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"
              ></path>
            </svg>
          </a>
          <a href="#" class="social-link">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"
              ></path>
            </svg>
          </a>
          <a href="#" class="social-link">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"
              ></path>
            </svg>
          </a>
        </div>
      </div>
    </footer>

    <script>
      const menuToggle = document.getElementById("menu-toggle");
      const sidebar = document.querySelector(".sidebar");

      menuToggle.addEventListener("click", () => {
        sidebar.classList.toggle("active");
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // DOM Elements
        const themeToggle = document.getElementById("theme-toggle");
        const navItems = document.querySelectorAll(".sidebar-nav li");
        const sections = document.querySelectorAll(".section");
        const currentDateEl = document.getElementById("current-date");
        const prevDateBtn = document.querySelector(".date-nav.prev");
        const nextDateBtn = document.querySelector(".date-nav.next");
        const chartPeriodSelect = document.getElementById("chart-period");
        const chartTypeBtns = document.querySelectorAll(".chart-type-btn");
        const addTransactionBtns = document.querySelectorAll(
          ".add-transaction-btn"
        );
        const transactionModal = document.getElementById("transaction-modal");
        const categoryModal = document.getElementById("category-modal");
        const accountModal = document.getElementById("account-modal");
        const closeModalBtns = document.querySelectorAll(".close-modal");
        const cancelBtns = document.querySelectorAll(".cancel-btn");
        const transactionForm = document.getElementById("transaction-form");
        const categoryForm = document.getElementById("category-form");
        const accountForm = document.getElementById("account-form");
        const addCategoryBtn = document.getElementById("add-category-btn");
        const addAccountBtn = document.getElementById("add-account-btn");
        const addFirstAccountBtn = document.getElementById(
          "add-first-account-btn"
        );
        const colorOptions = document.querySelectorAll(".color-option");
        const transactionTypeRadios = document.querySelectorAll(
          'input[name="transaction-type"]'
        );
        const transactionCategorySelect = document.getElementById(
          "transaction-category"
        );
        const transactionAccountSelect = document.getElementById(
          "transaction-account"
        );
        const categoryTypeInput = document.getElementById("category-type");
        const categoryColorInput = document.getElementById("category-color");
        const categoryNameInput = document.getElementById("category-name");
        const transactionSearch = document.getElementById("transaction-search");
        const transactionTypeFilter = document.getElementById(
          "transaction-type-filter"
        );
        const transactionCategoryFilter = document.getElementById(
          "transaction-category-filter"
        );
        const transactionDateFilter = document.getElementById(
          "transaction-date-filter"
        );
        const clearFiltersBtn = document.getElementById("clear-filters");
        const sortBtns = document.querySelectorAll(".sort-btn");
        const totalBudgetEl = document.getElementById("total-budget");
        const totalIncomeEl = document.getElementById("total-income");
        const totalExpensesEl = document.getElementById("total-expenses");
        const savingsRateEl = document.getElementById("savings-rate");
        const recentTransactionsList = document.getElementById(
          "recent-transactions-list"
        );
        const transactionsTableBody = document.getElementById(
          "transactions-table-body"
        );
        const transactionsEmptyState = document.getElementById(
          "transactions-empty-state"
        );

        // Additional DOM elements
        const budgetProgressCards = document.querySelector(
          ".budget-progress-cards"
        );
        const addBudgetBtns = document.querySelectorAll(".add-budget-btn");
        const goalsContainer = document.querySelector(".goals-container");
        const addGoalBtns = document.querySelectorAll(".add-goal-btn");
        const reportTypeSelect = document.getElementById("report-type");
        const reportStartDate = document.getElementById("report-start-date");
        const reportEndDate = document.getElementById("report-end-date");
        const generateReportBtn = document.querySelector(
          ".generate-report-btn"
        );
        const reportContent = document.querySelector(".report-content");
        const exportBtn = document.querySelector(".export-btn");
        const accountsContainer = document.getElementById("accounts-container");

        // Charts
        let incomeExpenseChart;
        let expenseCategoriesChart;

        // App State
        const state = {
          theme: localStorage.getItem("theme") || "light",
          currentSection: "dashboard",
          currentDate: new Date(),
          chartPeriod: "month",
          chartType: "pie",
          transactions: [],
          accounts: [],
          categories: {
            inc: [
              { id: "salary", name: "Salary", color: "#28B9B5" },
              { id: "freelance", name: "Freelance", color: "#66CC99" },
              { id: "investments", name: "Investments", color: "#6666FF" },
            ],
            exp: [
              { id: "housing", name: "Housing", color: "#FF5049" },
              { id: "food", name: "Food", color: "#FFBB00" },
              { id: "transport", name: "Transport", color: "#FF9999" },
              { id: "entertainment", name: "Entertainment", color: "#9966FF" },
              { id: "utilities", name: "Utilities", color: "#99CCFF" },
            ],
          },
          filters: {
            search: "",
            type: "all",
            category: "all",
            date: "all",
          },
          sort: {
            field: "date",
            direction: "desc",
          },
          pagination: {
            currentPage: 1,
            itemsPerPage: 10,
            totalPages: 1,
          },
          budgets: [],
          goals: [],
          reports: {
            type: "monthly",
            startDate: "",
            endDate: "",
            data: null,
          },
        };

        // Initialize App
        function initApp() {
          // Apply saved theme
          if (state.theme === "dark") {
            document.body.classList.add("dark-theme");
          }

          // Set current date
          updateDateDisplay();

          // Initialize charts
          initCharts();

          // Load data from localStorage
          loadData();

          // Update UI
          updateUI();

          // Set up event listeners
          setupEventListeners();
        }

        // Event Listeners
        function setupEventListeners() {
          // Theme toggle
          themeToggle.addEventListener("click", toggleTheme);

          // Navigation
          navItems.forEach((item) => {
            item.addEventListener("click", () => {
              const section = item.getAttribute("data-section");
              changeSection(section);
            });
          });

          // Date navigation
          prevDateBtn.addEventListener("click", () => {
            navigateDate("prev");
          });

          nextDateBtn.addEventListener("click", () => {
            navigateDate("next");
          });

          // Chart period change
          chartPeriodSelect.addEventListener("change", () => {
            state.chartPeriod = chartPeriodSelect.value;
            updateCharts();
          });

          // Chart type buttons
          chartTypeBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              const type = btn.getAttribute("data-type");
              changeChartType(type);
            });
          });

          // Add transaction buttons
          addTransactionBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              openModal(transactionModal);
            });
          });

          // Add account buttons
          if (addAccountBtn) {
            addAccountBtn.addEventListener("click", () => {
              openModal(accountModal);
            });
          }

          if (addFirstAccountBtn) {
            addFirstAccountBtn.addEventListener("click", () => {
              openModal(accountModal);
            });
          }

          // Close modal buttons
          closeModalBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              closeModal(btn.closest(".modal"));
            });
          });

          // Cancel buttons
          cancelBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              closeModal(btn.closest(".modal"));
            });
          });

          // Add category button
          addCategoryBtn.addEventListener("click", () => {
            const type = document.querySelector(
              'input[name="transaction-type"]:checked'
            ).value;
            categoryTypeInput.value = type;
            openModal(categoryModal);
          });

          // Color options
          colorOptions.forEach((option) => {
            option.addEventListener("click", () => {
              colorOptions.forEach((opt) => opt.classList.remove("selected"));
              option.classList.add("selected");
              categoryColorInput.value = option.getAttribute("data-color");
            });
          });

          // Transaction type change
          transactionTypeRadios.forEach((radio) => {
            radio.addEventListener("change", updateCategoryOptions);
          });

          // Transaction form submit
          transactionForm.addEventListener("submit", handleTransactionSubmit);

          // Category form submit
          categoryForm.addEventListener("submit", handleCategorySubmit);

          // Account form submit
          accountForm.addEventListener("submit", handleAccountSubmit);

          // Search and filters
          transactionSearch.addEventListener("input", () => {
            state.filters.search = transactionSearch.value.toLowerCase();
            state.pagination.currentPage = 1;
            updateTransactionsTable();
          });

          transactionTypeFilter.addEventListener("change", () => {
            state.filters.type = transactionTypeFilter.value;
            state.pagination.currentPage = 1;
            updateTransactionsTable();
          });

          transactionCategoryFilter.addEventListener("change", () => {
            state.filters.category = transactionCategoryFilter.value;
            state.pagination.currentPage = 1;
            updateTransactionsTable();
          });

          transactionDateFilter.addEventListener("change", () => {
            state.filters.date = transactionDateFilter.value;
            state.pagination.currentPage = 1;
            updateTransactionsTable();
          });

          clearFiltersBtn.addEventListener("click", () => {
            state.filters = {
              search: "",
              type: "all",
              category: "all",
              date: "all",
            };
            transactionSearch.value = "";
            transactionTypeFilter.value = "all";
            transactionCategoryFilter.value = "all";
            transactionDateFilter.value = "all";
            state.pagination.currentPage = 1;
            updateTransactionsTable();
          });

          // Sort buttons
          sortBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              const field = btn.getAttribute("data-sort");
              if (state.sort.field === field) {
                state.sort.direction =
                  state.sort.direction === "asc" ? "desc" : "asc";
              } else {
                state.sort.field = field;
                state.sort.direction = "asc";
              }
              updateTransactionsTable();
            });
          });

          // Budget buttons
          addBudgetBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              openBudgetModal();
            });
          });

          // Goal buttons
          addGoalBtns.forEach((btn) => {
            btn.addEventListener("click", () => {
              openGoalModal();
            });
          });

          // Report controls
          reportTypeSelect.addEventListener("change", () => {
            state.reports.type = reportTypeSelect.value;
          });

          generateReportBtn.addEventListener("click", () => {
            generateReport();
          });

          exportBtn.addEventListener("click", () => {
            exportReport();
          });

          // Set default dates for report
          const today = new Date();
          const firstDayOfMonth = new Date(
            today.getFullYear(),
            today.getMonth(),
            1
          );
          const lastDayOfMonth = new Date(
            today.getFullYear(),
            today.getMonth() + 1,
            0
          );

          reportStartDate.valueAsDate = firstDayOfMonth;
          reportEndDate.valueAsDate = lastDayOfMonth;
        }

        // Theme Toggle
        function toggleTheme() {
          state.theme = state.theme === "light" ? "dark" : "light";
          document.body.classList.toggle("dark-theme");
          localStorage.setItem("theme", state.theme);

          // Update charts for theme
          updateCharts();
        }

        // Change Section
        function changeSection(section) {
          state.currentSection = section;

          // Update active nav item
          navItems.forEach((item) => {
            if (item.getAttribute("data-section") === section) {
              item.classList.add("active");
            } else {
              item.classList.remove("active");
            }
          });

          // Show active section
          sections.forEach((sectionEl) => {
            if (sectionEl.id === section) {
              sectionEl.classList.add("active");
            } else {
              sectionEl.classList.remove("active");
            }
          });

          // Update UI for specific sections
          if (section === "transactions") {
            updateTransactionsTable();
          } else if (section === "budget") {
            updateBudgetSection();
          } else if (section === "goals") {
            updateGoalsSection();
          } else if (section === "accounts") {
            updateAccountsSection();
          } else if (section === "reports") {
            // Set default dates if not already set
            if (!state.reports.startDate) {
              const today = new Date();
              state.reports.startDate = new Date(
                today.getFullYear(),
                today.getMonth(),
                1
              )
                .toISOString()
                .split("T")[0];
              state.reports.endDate = new Date(
                today.getFullYear(),
                today.getMonth() + 1,
                0
              )
                .toISOString()
                .split("T")[0];
            }
          }
        }

        // Date Navigation
        function navigateDate(direction) {
          const currentDate = state.currentDate;

          if (direction === "prev") {
            currentDate.setMonth(currentDate.getMonth() - 1);
          } else if (direction === "next") {
            currentDate.setMonth(currentDate.getMonth() + 1);
          }

          updateDateDisplay();
          updateUI();
        }

        function updateDateDisplay() {
          const options = { month: "long", year: "numeric" };
          currentDateEl.textContent = state.currentDate.toLocaleDateString(
            "en-US",
            options
          );
        }

        // Chart Functions
        function initCharts() {
          // Income vs Expense Chart
          const incomeExpenseCtx = document
            .getElementById("income-expense-chart")
            .getContext("2d");
          incomeExpenseChart = new Chart(incomeExpenseCtx, {
            type: "bar",
            data: {
              labels: [],
              datasets: [
                {
                  label: "Income",
                  backgroundColor: "#10b981",
                  borderColor: "#10b981",
                  borderWidth: 1,
                },
                {
                  label: "Expenses",
                  backgroundColor: "#ef4444",
                  borderColor: "#ef4444",
                  borderWidth: 1,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                y: {
                  beginAtZero: true,
                  grid: {
                    color:
                      state.theme === "dark"
                        ? "rgba(255, 255, 255, 0.1)"
                        : "rgba(0, 0, 0, 0.1)",
                  },
                },
                x: {
                  grid: {
                    color:
                      state.theme === "dark"
                        ? "rgba(255, 255, 255, 0.1)"
                        : "rgba(0, 0, 0, 0.1)",
                  },
                },
              },
              plugins: {
                legend: {
                  labels: {
                    color: state.theme === "dark" ? "#f1f5f9" : "#1e293b",
                  },
                },
              },
            },
          });

          // Expense Categories Chart
          const expenseCategoriesCtx = document
            .getElementById("expense-categories-chart")
            .getContext("2d");
          expenseCategoriesChart = new Chart(expenseCategoriesCtx, {
            type: "pie",
            data: {
              labels: [],
              datasets: [
                {
                  data: [],
                  backgroundColor: [],
                  borderWidth: 1,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  position: "right",
                  labels: {
                    color: state.theme === "dark" ? "#f1f5f9" : "#1e293b",
                  },
                },
              },
            },
          });
        }

        function updateCharts() {
          // Get data for charts based on period
          const { incomeData, expenseData, categoryData } = getChartData();

          // Update Income vs Expense Chart
          incomeExpenseChart.data.labels = incomeData.labels;
          incomeExpenseChart.data.datasets[0].data = incomeData.values;
          incomeExpenseChart.data.datasets[1].data = expenseData.values;

          // Update chart theme
          incomeExpenseChart.options.scales.y.grid.color =
            state.theme === "dark"
              ? "rgba(255, 255, 255, 0.1)"
              : "rgba(0, 0, 0, 0.1)";
          incomeExpenseChart.options.scales.x.grid.color =
            state.theme === "dark"
              ? "rgba(255, 255, 255, 0.1)"
              : "rgba(0, 0, 0, 0.1)";
          incomeExpenseChart.options.plugins.legend.labels.color =
            state.theme === "dark" ? "#f1f5f9" : "#1e293b";

          incomeExpenseChart.update();

          // Update Expense Categories Chart
          expenseCategoriesChart.data.labels = categoryData.labels;
          expenseCategoriesChart.data.datasets[0].data = categoryData.values;
          expenseCategoriesChart.data.datasets[0].backgroundColor =
            categoryData.colors;

          // Update chart theme
          expenseCategoriesChart.options.plugins.legend.labels.color =
            state.theme === "dark" ? "#f1f5f9" : "#1e293b";

          expenseCategoriesChart.update();
        }

        function changeChartType(type) {
          state.chartType = type;

          // Update active button
          chartTypeBtns.forEach((btn) => {
            if (btn.getAttribute("data-type") === type) {
              btn.classList.add("active");
            } else {
              btn.classList.remove("active");
            }
          });

          // Change chart type
          expenseCategoriesChart.config.type = type;
          expenseCategoriesChart.update();
        }

        function getChartData() {
          const now = new Date();
          const currentYear = now.getFullYear();
          const currentMonth = now.getMonth();

          let startDate, endDate;
          let labels = [];

          // Set date range based on period
          if (state.chartPeriod === "week") {
            // Get current week (Sunday to Saturday)
            const day = now.getDay(); // 0 = Sunday, 6 = Saturday
            startDate = new Date(now);
            startDate.setDate(now.getDate() - day);
            endDate = new Date(startDate);
            endDate.setDate(startDate.getDate() + 6);

            // Create labels for each day of the week
            for (let i = 0; i < 7; i++) {
              const date = new Date(startDate);
              date.setDate(startDate.getDate() + i);
              labels.push(
                date.toLocaleDateString("en-US", { weekday: "short" })
              );
            }
          } else if (state.chartPeriod === "month") {
            // Current month
            startDate = new Date(currentYear, currentMonth, 1);
            endDate = new Date(currentYear, currentMonth + 1, 0);

            // Create labels for each week of the month
            const weeks = Math.ceil(endDate.getDate() / 7);
            for (let i = 0; i < weeks; i++) {
              labels.push(`Week ${i + 1}`);
            }
          } else if (state.chartPeriod === "year") {
            // Current year
            startDate = new Date(currentYear, 0, 1);
            endDate = new Date(currentYear, 11, 31);

            // Create labels for each month
            const monthNames = [
              "Jan",
              "Feb",
              "Mar",
              "Apr",
              "May",
              "Jun",
              "Jul",
              "Aug",
              "Sep",
              "Oct",
              "Nov",
              "Dec",
            ];
            labels = monthNames;
          }

          // Filter transactions by date range
          const filteredTransactions = state.transactions.filter(
            (transaction) => {
              const transactionDate = new Date(transaction.date);
              return transactionDate >= startDate && transactionDate <= endDate;
            }
          );

          // Prepare data for income vs expense chart
          const incomeValues = Array(labels.length).fill(0);
          const expenseValues = Array(labels.length).fill(0);

          filteredTransactions.forEach((transaction) => {
            const transactionDate = new Date(transaction.date);
            let index;

            if (state.chartPeriod === "week") {
              // Day of week (0-6)
              index = transactionDate.getDay();
            } else if (state.chartPeriod === "month") {
              // Week of month (0-4)
              index = Math.floor((transactionDate.getDate() - 1) / 7);
            } else if (state.chartPeriod === "year") {
              // Month of year (0-11)
              index = transactionDate.getMonth();
            }

            if (transaction.type === "inc") {
              incomeValues[index] += transaction.amount;
            } else {
              expenseValues[index] += transaction.amount;
            }
          });

          // Prepare data for expense categories chart
          const expensesByCategory = {};
          const categoryColors = {};

          filteredTransactions.forEach((transaction) => {
            if (transaction.type === "exp") {
              if (!expensesByCategory[transaction.category]) {
                expensesByCategory[transaction.category] = 0;

                // Find category color
                const category = state.categories.exp.find(
                  (cat) => cat.id === transaction.category
                );
                categoryColors[transaction.category] = category
                  ? category.color
                  : "#999";
              }

              expensesByCategory[transaction.category] += transaction.amount;
            }
          });

          const categoryLabels = Object.keys(expensesByCategory).map((id) => {
            const category = state.categories.exp.find((cat) => cat.id === id);
            return category ? category.name : id;
          });
          const categoryValues = Object.values(expensesByCategory);
          const categoryColorValues = Object.keys(expensesByCategory).map(
            (id) => categoryColors[id]
          );

          return {
            incomeData: {
              labels,
              values: incomeValues,
            },
            expenseData: {
              labels,
              values: expenseValues,
            },
            categoryData: {
              labels: categoryLabels,
              values: categoryValues,
              colors: categoryColorValues,
            },
          };
        }

        // Modal Functions
        function openModal(modal) {
          modal.classList.add("active");

          // Reset form if opening transaction modal
          if (modal === transactionModal) {
            resetTransactionForm();
          }

          // Reset form if opening category modal
          if (modal === categoryModal) {
            resetCategoryForm();
          }

          // Reset form if opening account modal
          if (modal === accountModal) {
            resetAccountForm();
          }
        }

        function closeModal(modal) {
          modal.classList.remove("active");
        }

        // Form Functions
        function resetTransactionForm() {
          transactionForm.reset();
          document.getElementById("transaction-date").valueAsDate = new Date();
          updateCategoryOptions();
          updateAccountOptions();

          // Reset form submit handler
          transactionForm.onsubmit = handleTransactionSubmit;

          // Remove transaction ID if it exists
          const idInput = document.getElementById("transaction-id");
          if (idInput) {
            idInput.value = "";
          }
        }

        function resetCategoryForm() {
          categoryForm.reset();
          colorOptions.forEach((option) => option.classList.remove("selected"));
          categoryColorInput.value = "";
        }

        function resetAccountForm() {
          accountForm.reset();
          document.getElementById("account-id").value = "";
          document.getElementById("account-balance").value = "0";

          // Reset modal title
          accountModal.querySelector(".modal-header h3").textContent =
            "Add Account";
        }

        function updateCategoryOptions() {
          const type = document.querySelector(
            'input[name="transaction-type"]:checked'
          ).value;
          const categories = state.categories[type];

          // Clear current options
          transactionCategorySelect.innerHTML = "";

          // Add options
          categories.forEach((category) => {
            const option = document.createElement("option");
            option.value = category.id;
            option.textContent = category.name;
            transactionCategorySelect.appendChild(option);
          });
        }

        function updateAccountOptions() {
          // Clear current options
          transactionAccountSelect.innerHTML = "";

          // Add options
          state.accounts.forEach((account) => {
            const option = document.createElement("option");
            option.value = account.id;
            option.textContent = account.name;
            transactionAccountSelect.appendChild(option);
          });

          // If no accounts, add a default option
          if (state.accounts.length === 0) {
            const option = document.createElement("option");
            option.value = "";
            option.textContent = "No accounts available";
            option.disabled = true;
            option.selected = true;
            transactionAccountSelect.appendChild(option);
          }
        }

        function handleTransactionSubmit(e) {
          e.preventDefault();

          // Check if there are accounts
          if (state.accounts.length === 0) {
            alert("Please add an account first");
            closeModal(transactionModal);
            openModal(accountModal);
            return;
          }

          const type = document.querySelector(
            'input[name="transaction-type"]:checked'
          ).value;
          const amount = Number.parseFloat(
            document.getElementById("transaction-amount").value
          );
          const description = document.getElementById(
            "transaction-description"
          ).value;
          const category = document.getElementById(
            "transaction-category"
          ).value;
          const account = document.getElementById("transaction-account").value;
          const date = document.getElementById("transaction-date").value;
          const notes = document.getElementById("transaction-notes").value;

          // Create new transaction
          const newTransaction = {
            id: generateId(),
            type,
            amount,
            description,
            category,
            account,
            date,
            notes,
            createdAt: new Date().toISOString(),
          };

          // Add to state
          state.transactions.push(newTransaction);

          // Update account balance
          updateAccountBalance(account, type, amount);

          // Update UI
          updateUI();

          // Save data
          saveData();

          // Close modal
          closeModal(transactionModal);
        }

        function updateAccountBalance(accountId, type, amount) {
          const accountIndex = state.accounts.findIndex(
            (a) => a.id === accountId
          );
          if (accountIndex !== -1) {
            if (type === "inc") {
              state.accounts[accountIndex].balance += amount;
            } else {
              state.accounts[accountIndex].balance -= amount;
            }
          }
        }

        function handleCategorySubmit(e) {
          e.preventDefault();

          const type = document.getElementById("category-type").value;
          const name = document.getElementById("category-name").value;
          const color = document.getElementById("category-color").value;
          const icon = document.getElementById("category-icon").value;

          if (!name || !color) {
            alert("Please enter a name and select a color");
            return;
          }

          // Create new category
          const newCategory = {
            id: name.toLowerCase().replace(/\s+/g, "-"),
            name,
            color,
            icon,
          };

          // Add to state
          state.categories[type].push(newCategory);

          // Update category options in transaction form
          updateCategoryOptions();

          // Update category filter options
          updateCategoryFilterOptions();

          // Save data
          saveData();

          // Close modal
          closeModal(categoryModal);
        }

        function handleAccountSubmit(e) {
          e.preventDefault();

          const id = document.getElementById("account-id").value;
          const name = document.getElementById("account-name").value;
          const type = document.getElementById("account-type").value;
          const balance = parseFloat(
            document.getElementById("account-balance").value
          );
          const accountNumber = document.getElementById("account-number").value;
          const notes = document.getElementById("account-notes").value;

          if (id) {
            // Update existing account
            const index = state.accounts.findIndex((a) => a.id === id);
            if (index !== -1) {
              state.accounts[index] = {
                ...state.accounts[index],
                name,
                type,
                balance,
                accountNumber,
                notes,
                updatedAt: new Date().toISOString(),
              };
            }
          } else {
            // Create new account
            const newAccount = {
              id: generateId(),
              name,
              type,
              balance,
              accountNumber,
              notes,
              createdAt: new Date().toISOString(),
            };

            // Add to state
            state.accounts.push(newAccount);
          }

          // Update UI
          updateAccountsSection();
          updateAccountOptions();

          // Save data
          saveData();

          // Close modal
          closeModal(accountModal);
        }

        // Helper Functions
        function generateId() {
          return (
            Math.random().toString(36).substring(2, 15) +
            Math.random().toString(36).substring(2, 15)
          );
        }

        function formatCurrency(amount) {
          return new Intl.NumberFormat("en-IN", {
            style: "currency",
            currency: "INR",
            maximumFractionDigits: 2,
          }).format(amount);
        }

        function formatDate(dateString) {
          const date = new Date(dateString);
          return date.toLocaleDateString("en-IN", {
            year: "numeric",
            month: "short",
            day: "numeric",
          });
        }

        // UI Update Functions
        function updateUI() {
          // Calculate totals
          const totals = calculateTotals();

          // Update summary cards
          totalBudgetEl.textContent = formatCurrency(totals.budget);
          totalIncomeEl.textContent = formatCurrency(totals.income);
          totalExpensesEl.textContent = formatCurrency(totals.expenses);
          savingsRateEl.textContent = `${totals.savingsRate}%`;

          // Update trends
          updateTrends(totals);

          // Update charts
          updateCharts();

          // Update recent transactions
          updateRecentTransactions();

          // Update budget section if on budget page
          if (state.currentSection === "budget") {
            updateBudgetSection();
          }

          // Update goals section if on goals page
          if (state.currentSection === "goals") {
            updateGoalsSection();
          }

          // Update accounts section if on accounts page
          if (state.currentSection === "accounts") {
            updateAccountsSection();
          }

          // Update category filter options
          updateCategoryFilterOptions();

          // Update transactions table if on transactions page
          if (state.currentSection === "transactions") {
            updateTransactionsTable();
          }
        }

        function updateTrends(totals) {
          // Calculate trends compared to previous month
          const prevMonthTransactions = getPreviousMonthTransactions();
          const prevIncome = prevMonthTransactions
            .filter((t) => t.type === "inc")
            .reduce((sum, t) => sum + t.amount, 0);
          const prevExpenses = prevMonthTransactions
            .filter((t) => t.type === "exp")
            .reduce((sum, t) => sum + t.amount, 0);
          const prevBudget = prevIncome - prevExpenses;
          const prevSavingsRate =
            prevIncome > 0 ? Math.round((prevBudget / prevIncome) * 100) : 0;

          // Calculate percentage changes
          const incomeTrend =
            prevIncome > 0
              ? Math.round(((totals.income - prevIncome) / prevIncome) * 100)
              : 0;
          const expensesTrend =
            prevExpenses > 0
              ? Math.round(
                  ((totals.expenses - prevExpenses) / prevExpenses) * 100
                )
              : 0;
          const budgetTrend =
            prevBudget > 0
              ? Math.round(((totals.budget - prevBudget) / prevBudget) * 100)
              : 0;
          const savingsRateTrend =
            prevSavingsRate > 0 ? totals.savingsRate - prevSavingsRate : 0;

          // Update trend elements
          document.querySelector(".total-budget .trend").innerHTML = `
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="${
    budgetTrend >= 0 ? "M18 15L12 9L6 15" : "M6 9L12 15L18 9"
  }" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
<span>${Math.abs(budgetTrend)}%</span>
`;
          document.querySelector(".total-budget .trend").className = `trend ${
            budgetTrend >= 0 ? "positive" : "negative"
          }`;

          document.querySelector(".total-income .trend").innerHTML = `
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="${
    incomeTrend >= 0 ? "M18 15L12 9L6 15" : "M6 9L12 15L18 9"
  }" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
<span>${Math.abs(incomeTrend)}%</span>
`;
          document.querySelector(".total-income .trend").className = `trend ${
            incomeTrend >= 0 ? "positive" : "negative"
          }`;

          document.querySelector(".total-expenses .trend").innerHTML = `
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="${
    expensesTrend <= 0 ? "M18 15L12 9L6 15" : "M6 9L12 15L18 9"
  }" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
<span>${Math.abs(expensesTrend)}%</span>
`;
          document.querySelector(".total-expenses .trend").className = `trend ${
            expensesTrend <= 0 ? "positive" : "negative"
          }`;

          document.querySelector(".savings-rate .trend").innerHTML = `
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="${
    savingsRateTrend >= 0 ? "M18 15L12 9L6 15" : "M6 9L12 15L18 9"
  }" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
<span>${Math.abs(savingsRateTrend)}%</span>
`;
          document.querySelector(".savings-rate .trend").className = `trend ${
            savingsRateTrend >= 0 ? "positive" : "negative"
          }`;
        }

        function getPreviousMonthTransactions() {
          const today = new Date();
          const currentMonth = today.getMonth();
          const currentYear = today.getFullYear();

          const prevMonth = currentMonth === 0 ? 11 : currentMonth - 1;
          const prevMonthYear =
            currentMonth === 0 ? currentYear - 1 : currentYear;

          const startDate = new Date(prevMonthYear, prevMonth, 1);
          const endDate = new Date(currentYear, currentMonth, 0);

          return state.transactions.filter((t) => {
            const date = new Date(t.date);
            return date >= startDate && date <= endDate;
          });
        }

        function calculateTotals() {
          // Get current month transactions
          const today = new Date();
          const currentMonth = today.getMonth();
          const currentYear = today.getFullYear();

          const startDate = new Date(currentYear, currentMonth, 1);
          const endDate = new Date(currentYear, currentMonth + 1, 0);

          const currentMonthTransactions = state.transactions.filter((t) => {
            const date = new Date(t.date);
            return date >= startDate && date <= endDate;
          });

          const income = currentMonthTransactions
            .filter((transaction) => transaction.type === "inc")
            .reduce((sum, transaction) => sum + transaction.amount, 0);

          const expenses = currentMonthTransactions
            .filter((transaction) => transaction.type === "exp")
            .reduce((sum, transaction) => sum + transaction.amount, 0);

          const budget = income - expenses;
          const savingsRate =
            income > 0 ? Math.round((budget / income) * 100) : 0;

          return {
            income,
            expenses,
            budget,
            savingsRate,
          };
        }

        function updateRecentTransactions() {
          // Sort transactions by date (newest first)
          const sortedTransactions = [...state.transactions]
            .sort((a, b) => new Date(b.date) - new Date(a.date))
            .slice(0, 5); // Get only the 5 most recent

          // Clear current list
          recentTransactionsList.innerHTML = "";

          // Show empty state if no transactions
          if (sortedTransactions.length === 0) {
            recentTransactionsList.innerHTML = `
  <div class="empty-state">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M19 5H5C3.89543 5 3 5.89543 3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V7C21 5.89543 20.1046 5 19 5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M3 7L12 13L21 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <p>No transactions yet</p>
    <button class="add-transaction-btn">Add Transaction</button>
  </div>
`;

            // Add event listener to the new button
            recentTransactionsList
              .querySelector(".add-transaction-btn")
              .addEventListener("click", () => {
                openModal(transactionModal);
              });

            return;
          }

          // Create transaction items
          sortedTransactions.forEach((transaction) => {
            const category = state.categories[transaction.type].find(
              (cat) => cat.id === transaction.category
            );
            const categoryName = category ? category.name : "Unknown";
            const categoryColor = category ? category.color : "#999";

            const transactionItem = document.createElement("div");
            transactionItem.className = "transaction-item";
            transactionItem.innerHTML = `
  <div class="transaction-info">
    <div class="transaction-title">${transaction.description}</div>
    <div class="transaction-details">
      <span class="transaction-date">${formatDate(transaction.date)}</span>
      <span class="transaction-category" style="background-color: ${categoryColor}">${categoryName}</span>
    </div>
  </div>
  <div class="transaction-amount ${
    transaction.type === "inc" ? "income" : "expense"
  }">
    ${transaction.type === "inc" ? "+" : "-"} ${formatCurrency(
              transaction.amount
            ).substring(1)}
  </div>
`;

            recentTransactionsList.appendChild(transactionItem);
          });

          // Add CSS for the transaction items
          if (!document.getElementById("transaction-item-styles")) {
            const style = document.createElement("style");
            style.id = "transaction-item-styles";
            style.textContent = `
  .transaction-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-md);
    border-bottom: 1px solid var(--border-color);
  }
  
  .transaction-info {
    flex: 1;
  }
  
  .transaction-title {
    font-weight: var(--font-medium);
    margin-bottom: var(--spacing-xs);
  }
  
  .transaction-details {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: var(--text-sm);
    color: var(--text-secondary);
  }
  
  .transaction-category {
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    color: white;
  }
  
  .transaction-amount {
    font-weight: var(--font-semibold);
  }
  
  .transaction-amount.income {
    color: var(--income-color);
  }
  
  .transaction-amount.expense {
    color: var(--expense-color);
  }
`;
            document.head.appendChild(style);
          }
        }

        function updateCategoryFilterOptions() {
          // Clear current options
          transactionCategoryFilter.innerHTML =
            '<option value="all">All Categories</option>';

          // Add income categories
          const incomeOptgroup = document.createElement("optgroup");
          incomeOptgroup.label = "Income";

          state.categories.inc.forEach((category) => {
            const option = document.createElement("option");
            option.value = `inc-${category.id}`;
            option.textContent = category.name;
            incomeOptgroup.appendChild(option);
          });

          transactionCategoryFilter.appendChild(incomeOptgroup);

          // Add expense categories
          const expenseOptgroup = document.createElement("optgroup");
          expenseOptgroup.label = "Expenses";

          state.categories.exp.forEach((category) => {
            const option = document.createElement("option");
            option.value = `exp-${category.id}`;
            option.textContent = category.name;
            expenseOptgroup.appendChild(option);
          });

          transactionCategoryFilter.appendChild(expenseOptgroup);
        }

        function updateTransactionsTable() {
          // Apply filters
          const filteredTransactions = state.transactions.filter(
            (transaction) => {
              // Search filter
              if (
                state.filters.search &&
                !transaction.description
                  .toLowerCase()
                  .includes(state.filters.search)
              ) {
                return false;
              }

              // Type filter
              if (
                state.filters.type !== "all" &&
                transaction.type !== state.filters.type
              ) {
                return false;
              }

              // Category filter
              if (state.filters.category !== "all") {
                const [type, categoryId] = state.filters.category.split("-");
                if (
                  transaction.type !== type ||
                  transaction.category !== categoryId
                ) {
                  return false;
                }
              }

              // Date filter
              if (state.filters.date !== "all") {
                const transactionDate = new Date(transaction.date);
                const now = new Date();

                if (state.filters.date === "today") {
                  const today = new Date(
                    now.getFullYear(),
                    now.getMonth(),
                    now.getDate()
                  );
                  if (transactionDate < today) {
                    return false;
                  }
                } else if (state.filters.date === "week") {
                  const day = now.getDay(); // 0 = Sunday, 6 = Saturday
                  const firstDayOfWeek = new Date(now);
                  firstDayOfWeek.setDate(now.getDate() - day);
                  firstDayOfWeek.setHours(0, 0, 0, 0);

                  if (transactionDate < firstDayOfWeek) {
                    return false;
                  }
                } else if (state.filters.date === "month") {
                  const firstDayOfMonth = new Date(
                    now.getFullYear(),
                    now.getMonth(),
                    1
                  );
                  if (transactionDate < firstDayOfMonth) {
                    return false;
                  }
                } else if (state.filters.date === "year") {
                  const firstDayOfYear = new Date(now.getFullYear(), 0, 1);
                  if (transactionDate < firstDayOfYear) {
                    return false;
                  }
                }
              }

              return true;
            }
          );

          // Apply sorting
          filteredTransactions.sort((a, b) => {
            let valueA, valueB;

            if (state.sort.field === "date") {
              valueA = new Date(a.date);
              valueB = new Date(b.date);
            } else if (state.sort.field === "amount") {
              valueA = a.amount;
              valueB = b.amount;
            } else if (state.sort.field === "category") {
              const categoryA = state.categories[a.type].find(
                (cat) => cat.id === a.category
              );
              const categoryB = state.categories[b.type].find(
                (cat) => cat.id === b.category
              );
              valueA = categoryA ? categoryA.name : "";
              valueB = categoryB ? categoryB.name : "";
            } else {
              valueA = a[state.sort.field];
              valueB = b[state.sort.field];
            }

            if (state.sort.direction === "asc") {
              return valueA > valueB ? 1 : -1;
            } else {
              return valueA < valueB ? 1 : -1;
            }
          });

          // Update pagination
          state.pagination.totalPages =
            Math.ceil(
              filteredTransactions.length / state.pagination.itemsPerPage
            ) || 1;

          if (state.pagination.currentPage > state.pagination.totalPages) {
            state.pagination.currentPage = state.pagination.totalPages;
          }

          // Get current page items
          const startIndex =
            (state.pagination.currentPage - 1) * state.pagination.itemsPerPage;
          const endIndex = startIndex + state.pagination.itemsPerPage;
          const currentPageItems = filteredTransactions.slice(
            startIndex,
            endIndex
          );

          // Update table
          transactionsTableBody.innerHTML = "";

          // Show empty state if no transactions
          if (currentPageItems.length === 0) {
            transactionsTableBody.innerHTML = "";
            transactionsEmptyState.style.display = "flex";
          } else {
            transactionsEmptyState.style.display = "none";

            // Create table rows
            currentPageItems.forEach((transaction) => {
              const category = state.categories[transaction.type].find(
                (cat) => cat.id === transaction.category
              );
              const categoryName = category ? category.name : "Unknown";
              const categoryColor = category ? category.color : "#999";

              const row = document.createElement("tr");
              row.innerHTML = `
    <td>${formatDate(transaction.date)}</td>
    <td>${transaction.description}</td>
    <td>
      <span class="category-badge" style="background-color: ${categoryColor}">${categoryName}</span>
    </td>
    <td class="${transaction.type === "inc" ? "income" : "expense"}">${
                transaction.type === "inc" ? "+" : "-"
              } ${formatCurrency(transaction.amount).substring(1)}</td>
    <td>
      <div class="action-buttons">
        <button class="edit-btn" data-id="${transaction.id}">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M18.5 2.50001C18.8978 2.10219 19.4374 1.87869 20 1.87869C20.5626 1.87869 21.1022 2.10219 21.5 2.50001C21.8978 2.89784 22.1213 3.4374 22.1213 4.00001C22.1213 4.56262 21.8978 5.10219 21.5 5.50001L12 15L8 16L9 12L18.5 2.50001Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button class="delete-btn" data-id="${transaction.id}">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </td>
  `;

              transactionsTableBody.appendChild(row);
            });

            // Add event listeners to action buttons
            document.querySelectorAll(".edit-btn").forEach((btn) => {
              btn.addEventListener("click", () => {
                const id = btn.getAttribute("data-id");
                editTransaction(id);
              });
            });

            document.querySelectorAll(".delete-btn").forEach((btn) => {
              btn.addEventListener("click", () => {
                const id = btn.getAttribute("data-id");
                deleteTransaction(id);
              });
            });
          }

          // Update pagination info
          document.getElementById("current-page").textContent =
            state.pagination.currentPage;
          document.getElementById("total-pages").textContent =
            state.pagination.totalPages;

          // Update pagination buttons
          const prevBtn = document.querySelector(".pagination-btn.prev");
          const nextBtn = document.querySelector(".pagination-btn.next");

          prevBtn.disabled = state.pagination.currentPage === 1;
          nextBtn.disabled =
            state.pagination.currentPage === state.pagination.totalPages;

          // Add event listeners to pagination buttons
          prevBtn.onclick = () => {
            if (state.pagination.currentPage > 1) {
              state.pagination.currentPage--;
              updateTransactionsTable();
            }
          };

          nextBtn.onclick = () => {
            if (state.pagination.currentPage < state.pagination.totalPages) {
              state.pagination.currentPage++;
              updateTransactionsTable();
            }
          };

          // Add CSS for the category badge
          if (!document.getElementById("category-badge-styles")) {
            const style = document.createElement("style");
            style.id = "category-badge-styles";
            style.textContent = `
  .category-badge {
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    color: white;
  }
  
  .action-buttons {
    display: flex;
    gap: var(--spacing-sm);
  }
  
  .edit-btn, .delete-btn {
    background: transparent;
    border: none;
    width: 28px;
    height: 28px;
    border-radius: var(--radius);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary);
    transition: background-color var(--transition-fast), color var(--transition-fast);
  }
  
  .edit-btn:hover {
    background-color: var(--bg-tertiary);
    color: var(--primary-color);
  }
  
  .delete-btn:hover {
    background-color: var(--bg-tertiary);
    color: var(--danger-color);
  }
  
  td.income {
    color: var(--income-color);
    font-weight: var(--font-medium);
  }
  
  td.expense {
    color: var(--expense-color);
    font-weight: var(--font-medium);
  }
`;
            document.head.appendChild(style);
          }
        }

        function editTransaction(id) {
          // Find transaction
          const transaction = state.transactions.find((t) => t.id === id);

          if (!transaction) return;

          // Fill form with transaction data
          document.querySelector(
            `input[name="transaction-type"][value="${transaction.type}"]`
          ).checked = true;
          document.getElementById("transaction-amount").value =
            transaction.amount;
          document.getElementById("transaction-description").value =
            transaction.description;
          document.getElementById("transaction-date").value = transaction.date;
          document.getElementById("transaction-notes").value =
            transaction.notes || "";

          // Update category options and select the right one
          updateCategoryOptions();
          document.getElementById("transaction-category").value =
            transaction.category;

          // Update account options and select the right one
          updateAccountOptions();
          document.getElementById("transaction-account").value =
            transaction.account;

          // Add transaction ID to form for update
          if (!document.getElementById("transaction-id")) {
            const idInput = document.createElement("input");
            idInput.type = "hidden";
            idInput.id = "transaction-id";
            transactionForm.appendChild(idInput);
          }

          document.getElementById("transaction-id").value = id;

          // Change form submit handler
          transactionForm.onsubmit = handleTransactionUpdate;

          // Open modal
          openModal(transactionModal);
        }

        function handleTransactionUpdate(e) {
          e.preventDefault();

          const id = document.getElementById("transaction-id").value;
          const type = document.querySelector(
            'input[name="transaction-type"]:checked'
          ).value;
          const amount = Number.parseFloat(
            document.getElementById("transaction-amount").value
          );
          const description = document.getElementById(
            "transaction-description"
          ).value;
          const category = document.getElementById(
            "transaction-category"
          ).value;
          const account = document.getElementById("transaction-account").value;
          const date = document.getElementById("transaction-date").value;
          const notes = document.getElementById("transaction-notes").value;

          // Find transaction index
          const index = state.transactions.findIndex((t) => t.id === id);

          if (index !== -1) {
            // Get the old transaction to reverse its effect on account balance
            const oldTransaction = state.transactions[index];

            // Reverse the old transaction's effect on account balance
            if (oldTransaction.account === account) {
              // If same account, just update the difference
              const difference = amount - oldTransaction.amount;
              if (type === "inc") {
                updateAccountBalance(account, "inc", difference);
              } else {
                updateAccountBalance(account, "exp", difference);
              }
            } else {
              // If different account, reverse old transaction and add new one
              if (oldTransaction.type === "inc") {
                updateAccountBalance(
                  oldTransaction.account,
                  "exp",
                  oldTransaction.amount
                );
              } else {
                updateAccountBalance(
                  oldTransaction.account,
                  "inc",
                  oldTransaction.amount
                );
              }

              // Add new transaction to the new account
              if (type === "inc") {
                updateAccountBalance(account, "inc", amount);
              } else {
                updateAccountBalance(account, "exp", amount);
              }
            }

            // Update transaction
            state.transactions[index] = {
              ...state.transactions[index],
              type,
              amount,
              description,
              category,
              account,
              date,
              notes,
              updatedAt: new Date().toISOString(),
            };

            // Update UI
            updateUI();

            // Save data
            saveData();

            // Reset form submit handler
            transactionForm.onsubmit = handleTransactionSubmit;

            // Close modal
            closeModal(transactionModal);
          }
        }

        function deleteTransaction(id) {
          if (confirm("Are you sure you want to delete this transaction?")) {
            // Find the transaction to reverse its effect on account balance
            const transaction = state.transactions.find((t) => t.id === id);

            if (transaction) {
              // Reverse the transaction's effect on account balance
              if (transaction.type === "inc") {
                updateAccountBalance(
                  transaction.account,
                  "exp",
                  transaction.amount
                );
              } else {
                updateAccountBalance(
                  transaction.account,
                  "inc",
                  transaction.amount
                );
              }
            }

            // Remove transaction from state
            state.transactions = state.transactions.filter((t) => t.id !== id);

            // Update UI
            updateUI();

            // Save data
            saveData();
          }
        }

        // Account Functions
        function updateAccountsSection() {
          // Clear current accounts
          accountsContainer.innerHTML = "";

          // Show empty state if no accounts
          if (state.accounts.length === 0) {
            accountsContainer.innerHTML = `
  <div class="empty-state">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M21 4H3C1.89543 4 1 4.89543 1 6V18C1 19.1046 1.89543 20 3 20H21C22.1046 20 23 19.1046 23 18V6C23 4.89543 22.1046 4 21 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M1 10H23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <p>No accounts added yet</p>
    <button class="add-transaction-btn" id="add-first-account-btn">Add Account</button>
  </div>
`;

            // Add event listener to the new button
            accountsContainer
              .querySelector("#add-first-account-btn")
              .addEventListener("click", () => {
                openModal(accountModal);
              });

            return;
          }

          // Create account cards
          state.accounts.forEach((account) => {
            const accountCard = document.createElement("div");
            accountCard.className = "account-card";
            accountCard.innerHTML = `
  <div class="account-header">
    <h3>${account.name}</h3>
    <span class="account-type">${account.type}</span>
  </div>
  <div class="account-balance">${formatCurrency(account.balance)}</div>
  <div class="account-details">
    ${
      account.accountNumber
        ? `<div>Account #: ${account.accountNumber}</div>`
        : ""
    }
    <div>Last updated: ${formatDate(
      account.updatedAt || account.createdAt
    )}</div>
  </div>
  <div class="account-actions">
    <button class="account-btn edit-account-btn" data-id="${account.id}">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M18.5 2.50001C18.8978 2.10219 19.4374 1.87869 20 1.87869C20.5626 1.87869 21.1022 2.10219 21.5 2.50001C21.8978 2.89784 22.1213 3.4374 22.1213 4.00001C22.1213 4.56262 21.8978 5.10219 21.5 5.50001L12 15L8 16L9 12L18.5 2.50001Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Edit
    </button>
    <button class="account-btn delete-account-btn" data-id="${account.id}">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Delete
    </button>
  </div>
`;

            accountsContainer.appendChild(accountCard);
          });

          // Add event listeners to account action buttons
          document.querySelectorAll(".edit-account-btn").forEach((btn) => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              editAccount(id);
            });
          });

          document.querySelectorAll(".delete-account-btn").forEach((btn) => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              deleteAccount(id);
            });
          });
        }

        function editAccount(id) {
          const account = state.accounts.find((a) => a.id === id);

          if (!account) return;

          // Fill form with account data
          document.getElementById("account-id").value = account.id;
          document.getElementById("account-name").value = account.name;
          document.getElementById("account-type").value = account.type;
          document.getElementById("account-balance").value = account.balance;
          document.getElementById("account-number").value =
            account.accountNumber || "";
          document.getElementById("account-notes").value = account.notes || "";

          // Update modal title
          accountModal.querySelector(".modal-header h3").textContent =
            "Edit Account";

          // Open modal
          openModal(accountModal);
        }

        function deleteAccount(id) {
          // Check if account has transactions
          const hasTransactions = state.transactions.some(
            (t) => t.account === id
          );

          if (hasTransactions) {
            alert(
              "Cannot delete account with transactions. Please delete or move the transactions first."
            );
            return;
          }

          if (confirm("Are you sure you want to delete this account?")) {
            // Remove account from state
            state.accounts = state.accounts.filter((a) => a.id !== id);

            // Update UI
            updateAccountsSection();
            updateAccountOptions();

            // Save data
            saveData();
          }
        }

        // Budget Functions
        function updateBudgetSection() {
          // Clear current cards
          budgetProgressCards.innerHTML = "";

          // Show empty state if no budgets
          if (state.budgets.length === 0) {
            budgetProgressCards.innerHTML = `
  <div class="empty-state">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M21 4H3C1.89543 4 1 4.89543 1 6V18C1 19.1046 1.89543 20 3 20H21C22.1046 20 23 19.1046 23 18V6C23 4.89543 22.1046 4 21 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M1 10H23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <p>No budgets created yet</p>
    <button class="add-budget-btn">Create Budget</button>
  </div>
`;

            // Add event listener to the new button
            budgetProgressCards
              .querySelector(".add-budget-btn")
              .addEventListener("click", () => {
                openBudgetModal();
              });

            return;
          }

          // Create budget cards
          state.budgets.forEach((budget) => {
            const category = state.categories.exp.find(
              (cat) => cat.id === budget.category
            );
            const categoryColor = category ? category.color : "#999";
            const progress = (budget.spent / budget.planned) * 100;
            const remaining = budget.planned - budget.spent;
            const isOverBudget = remaining < 0;

            const budgetCard = document.createElement("div");
            budgetCard.className = "budget-card";
            budgetCard.innerHTML = `
  <div class="budget-card-header">
    <h3>${budget.name}</h3>
    <span class="budget-category" style="background-color: ${categoryColor}">${
              category ? category.name : "General"
            }</span>
  </div>
  <div class="budget-amounts">
    <div class="budget-planned">
      <span class="label">Planned</span>
      <span class="value">${formatCurrency(budget.planned)}</span>
    </div>
    <div class="budget-spent">
      <span class="label">Spent</span>
      <span class="value">${formatCurrency(budget.spent)}</span>
    </div>
    <div class="budget-remaining ${isOverBudget ? "over-budget" : ""}">
      <span class="label">Remaining</span>
      <span class="value">${isOverBudget ? "-" : ""}${formatCurrency(
              Math.abs(remaining)
            )}</span>
    </div>
  </div>
  <div class="budget-progress-container">
    <div class="budget-progress-bar" style="width: ${Math.min(
      progress,
      100
    )}%; background-color: ${
              progress > 100 ? "var(--danger-color)" : categoryColor
            }"></div>
  </div>
  <div class="budget-progress-info">
    <span>${Math.round(progress)}% used</span>
    <span>${budget.period}</span>
  </div>
  <div class="budget-actions">
    <button class="edit-budget-btn" data-id="${budget.id}">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M18.5 2.50001C18.8978 2.10219 19.4374 1.87869 20 1.87869C20.5626 1.87869 21.1022 2.10219 21.5 2.50001C21.8978 2.89784 22.1213 3.4374 22.1213 4.00001C22.1213 4.56262 21.8978 5.10219 21.5 5.50001L12 15L8 16L9 12L18.5 2.50001Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Edit
    </button>
    <button class="delete-budget-btn" data-id="${budget.id}">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Delete
    </button>
  </div>
`;

            budgetProgressCards.appendChild(budgetCard);
          });

          // Add CSS for budget cards
          if (!document.getElementById("budget-card-styles")) {
            const style = document.createElement("style");
            style.id = "budget-card-styles";
            style.textContent = `
  .budget-overview {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--spacing-lg);
  }
  
  .budget-card {
    background-color: var(--bg-primary);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
    box-shadow: var(--shadow);
  }
  
  .budget-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-md);
  }
  
  .budget-card-header h3 {
    font-size: var(--text-lg);
    font-weight: var(--font-medium);
  }
  
  .budget-category {
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    color: white;
  }
  
  .budget-amounts {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-md);
  }
  
  .budget-planned, .budget-spent, .budget-remaining {
    display: flex;
    flex-direction: column;
  }
  
  .budget-amounts .label {
    font-size: var(--text-xs);
    color: var(--text-secondary);
    margin-bottom: var(--spacing-xs);
  }
  
  .budget-amounts .value {
    font-weight: var(--font-medium);
  }
  
  .budget-remaining.over-budget .value {
    color: var(--danger-color);
  }
  
  .budget-progress-container {
    height: 8px;
    background-color: var(--bg-tertiary);
    border-radius: var(--radius-full);
    overflow: hidden;
    margin-bottom: var(--spacing-xs);
  }
  
  .budget-progress-bar {
    height: 100%;
    border-radius: var(--radius-full);
    transition: width var(--transition);
  }
  
  .budget-progress-info {
    display: flex;
    justify-content: space-between;
    font-size: var(--text-xs);
    color: var(--text-secondary);
    margin-bottom: var(--spacing-md);
  }
  
  .budget-actions {
    display: flex;
    gap: var(--spacing-sm);
  }
  
  .edit-budget-btn, .delete-budget-btn {
    flex: 1;
    padding: var(--spacing-sm);
    border-radius: var(--radius);
    font-size: var(--text-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    transition: background-color var(--transition-fast);
  }
  
  .edit-budget-btn {
    background-color: var(--bg-tertiary);
    color: var(--text-primary);
    border: none;
  }
  
  .edit-budget-btn:hover {
    background-color: var(--border-color);
  }
  
  .delete-budget-btn {
    background-color: rgba(239, 68, 68, 0.1);
    color: var(--danger-color);
    border: none;
  }
  
  .delete-budget-btn:hover {
    background-color: rgba(239, 68, 68, 0.2);
  }
`;
            document.head.appendChild(style);
          }

          // Add event listeners to budget action buttons
          document.querySelectorAll(".edit-budget-btn").forEach((btn) => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              editBudget(id);
            });
          });

          document.querySelectorAll(".delete-budget-btn").forEach((btn) => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              deleteBudget(id);
            });
          });
        }

        function openBudgetModal(budgetId = null) {
          // Create modal if it doesn't exist
          if (!document.getElementById("budget-modal")) {
            const modal = document.createElement("div");
            modal.className = "modal";
            modal.id = "budget-modal";
            modal.innerHTML = `
  <div class="modal-content">
    <div class="modal-header">
      <h3>Create Budget</h3>
      <button class="close-modal">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <form id="budget-form">
        <input type="hidden" id="budget-id">
        <div class="form-group">
          <label for="budget-name">Budget Name</label>
          <input type="text" id="budget-name" required>
        </div>
        <div class="form-group">
          <label for="budget-category">Category</label>
          <select id="budget-category" required>
            <!-- Categories will be added dynamically -->
          </select>
        </div>
        <div class="form-group">
          <label for="budget-amount">Planned Amount</label>
          <div class="amount-input">
            <span class="currency-symbol">₹</span>
            <input type="number" id="budget-amount" step="0.01" min="0.01" required>
          </div>
        </div>
        <div class="form-group">
          <label for="budget-period">Period</label>
          <select id="budget-period" required>
            <option value="weekly">Weekly</option>
            <option value="monthly" selected>Monthly</option>
            <option value="quarterly">Quarterly</option>
            <option value="yearly">Yearly</option>
          </select>
        </div>
        <div class="form-group">
          <label for="budget-start-date">Start Date</label>
          <input type="date" id="budget-start-date" required>
        </div>
        <div class="form-group">
          <label for="budget-end-date">End Date</label>
          <input type="date" id="budget-end-date" required>
        </div>
        <div class="form-actions">
          <button type="button" class="cancel-btn">Cancel</button>
          <button type="submit" class="save-btn">Save Budget</button>
        </div>
      </form>
    </div>
  </div>
`;
            document.body.appendChild(modal);

            // Add event listeners
            const closeBtn = modal.querySelector(".close-modal");
            const cancelBtn = modal.querySelector(".cancel-btn");
            const form = modal.querySelector("#budget-form");

            closeBtn.addEventListener("click", () => {
              closeModal(modal);
            });

            cancelBtn.addEventListener("click", () => {
              closeModal(modal);
            });

            form.addEventListener("submit", handleBudgetSubmit);
          }

          const modal = document.getElementById("budget-modal");
          const form = modal.querySelector("#budget-form");
          const budgetIdInput = document.getElementById("budget-id");
          const budgetNameInput = document.getElementById("budget-name");
          const budgetCategorySelect =
            document.getElementById("budget-category");
          const budgetAmountInput = document.getElementById("budget-amount");
          const budgetPeriodSelect = document.getElementById("budget-period");
          const budgetStartDateInput =
            document.getElementById("budget-start-date");
          const budgetEndDateInput = document.getElementById("budget-end-date");

          // Reset form
          form.reset();

          // Set default dates
          const today = new Date();
          const firstDayOfMonth = new Date(
            today.getFullYear(),
            today.getMonth(),
            1
          );
          const lastDayOfMonth = new Date(
            today.getFullYear(),
            today.getMonth() + 1,
            0
          );

          budgetStartDateInput.valueAsDate = firstDayOfMonth;
          budgetEndDateInput.valueAsDate = lastDayOfMonth;

          // Populate category options
          budgetCategorySelect.innerHTML = "";
          state.categories.exp.forEach((category) => {
            const option = document.createElement("option");
            option.value = category.id;
            option.textContent = category.name;
            budgetCategorySelect.appendChild(option);
          });

          // If editing existing budget
          if (budgetId) {
            const budget = state.budgets.find((b) => b.id === budgetId);

            if (budget) {
              modal.querySelector(".modal-header h3").textContent =
                "Edit Budget";

              budgetIdInput.value = budget.id;
              budgetNameInput.value = budget.name;
              budgetCategorySelect.value = budget.category;
              budgetAmountInput.value = budget.planned;
              budgetPeriodSelect.value = budget.period;
              budgetStartDateInput.value = budget.startDate;
              budgetEndDateInput.value = budget.endDate;
            }
          } else {
            modal.querySelector(".modal-header h3").textContent =
              "Create Budget";
            budgetIdInput.value = "";
          }

          // Open modal
          openModal(modal);
        }

        function handleBudgetSubmit(e) {
          e.preventDefault();

          const budgetId = document.getElementById("budget-id").value;
          const name = document.getElementById("budget-name").value;
          const category = document.getElementById("budget-category").value;
          const planned = parseFloat(
            document.getElementById("budget-amount").value
          );
          const period = document.getElementById("budget-period").value;
          const startDate = document.getElementById("budget-start-date").value;
          const endDate = document.getElementById("budget-end-date").value;

          // Calculate spent amount based on transactions
          const spent = calculateSpentAmount(category, startDate, endDate);

          if (budgetId) {
            // Update existing budget
            const index = state.budgets.findIndex((b) => b.id === budgetId);

            if (index !== -1) {
              state.budgets[index] = {
                ...state.budgets[index],
                name,
                category,
                planned,
                spent,
                period,
                startDate,
                endDate,
                updatedAt: new Date().toISOString(),
              };
            }
          } else {
            // Create new budget
            const newBudget = {
              id: generateId(),
              name,
              category,
              planned,
              spent,
              period,
              startDate,
              endDate,
              createdAt: new Date().toISOString(),
            };

            state.budgets.push(newBudget);
          }

          // Update UI
          updateBudgetSection();

          // Save data
          saveData();

          // Close modal
          closeModal(document.getElementById("budget-modal"));
        }

        function calculateSpentAmount(category, startDate, endDate) {
          // Filter transactions by category and date range
          return state.transactions
            .filter((transaction) => {
              return (
                transaction.type === "exp" &&
                transaction.category === category &&
                transaction.date >= startDate &&
                transaction.date <= endDate
              );
            })
            .reduce((total, transaction) => total + transaction.amount, 0);
        }

        function editBudget(id) {
          openBudgetModal(id);
        }

        function deleteBudget(id) {
          if (confirm("Are you sure you want to delete this budget?")) {
            state.budgets = state.budgets.filter((b) => b.id !== id);
            updateBudgetSection();
            saveData();
          }
        }

        // Goals Functions
        function updateGoalsSection() {
          // Clear current goals
          goalsContainer.innerHTML = "";

          // Show empty state if no goals
          if (state.goals.length === 0) {
            goalsContainer.innerHTML = `
  <div class="empty-state">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M12 10C13.1046 10 14 10.8954 14 12C14 13.1046 13.1046 14 12 14C10.8954 14 10 13.1046 10 12C10 10.8954 10.8954 10 12 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <p>No goals created yet</p>
    <button class="add-goal-btn">Add Goal</button>
  </div>
`;

            // Add event listener to the new button
            goalsContainer
              .querySelector(".add-goal-btn")
              .addEventListener("click", () => {
                openGoalModal();
              });

            return;
          }

          // Create goal cards
          const goalsGrid = document.createElement("div");
          goalsGrid.className = "goals-grid";

          state.goals.forEach((goal) => {
            const progress = (goal.currentAmount / goal.targetAmount) * 100;
            const remaining = goal.targetAmount - goal.currentAmount;
            const deadline = new Date(goal.deadline);
            const today = new Date();
            const daysRemaining = Math.ceil(
              (deadline - today) / (1000 * 60 * 60 * 24)
            );

            const goalCard = document.createElement("div");
            goalCard.className = "goal-card";
            goalCard.innerHTML = `
  <div class="goal-card-header">
    <h3>${goal.name}</h3>
    <span class="goal-priority ${goal.priority}">${goal.priority}</span>
  </div>
  <div class="goal-amounts">
    <div class="goal-target">
      <span class="label">Target</span>
      <span class="value">${formatCurrency(goal.targetAmount)}</span>
    </div>
    <div class="goal-current">
      <span class="label">Current</span>
      <span class="value">${formatCurrency(goal.currentAmount)}</span>
    </div>
    <div class="goal-remaining">
      <span class="label">Remaining</span>
      <span class="value">${formatCurrency(remaining)}</span>
    </div>
  </div>
  <div class="goal-progress-container">
    <div class="goal-progress-bar" style="width: ${progress}%; background-color: ${
              goal.color
            }"></div>
  </div>
  <div class="goal-progress-info">
    <span>${Math.round(progress)}% complete</span>
    <span>${daysRemaining} days left</span>
  </div>
  <div class="goal-actions">
    <button class="edit-goal-btn" data-id="${goal.id}">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M18.5 2.50001C18.8978 2.10219 19.4374 1.87869 20 1.87869C20.5626 1.87869 21.1022 2.10219 21.5 2.50001C21.8978 2.89784 22.1213 3.4374 22.1213 4.00001C22.1213 4.56262 21.8978 5.10219 21.5 5.50001L12 15L8 16L9 12L18.5 2.50001Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Edit
    </button>
    <button class="delete-goal-btn" data-id="${goal.id}">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Delete
    </button>
  </div>
`;

            goalsGrid.appendChild(goalCard);
          });

          goalsContainer.appendChild(goalsGrid);

          // Add CSS for goal cards
          if (!document.getElementById("goal-card-styles")) {
            const style = document.createElement("style");
            style.id = "goal-card-styles";
            style.textContent = `
  .goals-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--spacing-lg);
  }
  
  .goal-card {
    background-color: var(--bg-primary);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
    box-shadow: var(--shadow);
  }
  
  .goal-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-md);
  }
  
  .goal-card-header h3 {
    font-size: var(--text-lg);
    font-weight: var(--font-medium);
  }
  
  .goal-priority {
    padding: 2px 8px;
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    color: white;
  }
  
  .goal-priority.high {
    background-color: var(--danger-color);
  }
  
  .goal-priority.medium {
    background-color: var(--warning-color);
  }
  
  .goal-priority.low {
    background-color: var(--success-color);
  }
  
  .goal-amounts {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-md);
  }
  
  .goal-target, .goal-current, .goal-remaining {
    display: flex;
    flex-direction: column;
  }
  
  .goal-amounts .label {
    font-size: var(--text-xs);
    color: var(--text-secondary);
    margin-bottom: var(--spacing-xs);
  }
  
  .goal-amounts .value {
    font-weight: var(--font-medium);
  }
  
  .goal-progress-container {
    height: 8px;
    background-color: var(--bg-tertiary);
    border-radius: var(--radius-full);
    overflow: hidden;
    margin-bottom: var(--spacing-xs);
  }
  
  .goal-progress-bar {
    height: 100%;
    border-radius: var(--radius-full);
    transition: width var(--transition);
  }
  
  .goal-progress-info {
    display: flex;
    justify-content: space-between;
    font-size: var(--text-xs);
    color: var(--text-secondary);
    margin-bottom: var(--spacing-md);
  }
  
  .goal-actions {
    display: flex;
    gap: var(--spacing-sm);
  }
  
  .edit-goal-btn, .delete-goal-btn {
    flex: 1;
    padding: var(--spacing-sm);
    border-radius: var(--radius);
    font-size: var(--text-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    transition: background-color var(--transition-fast);
    border: none;
  }
  
  .edit-goal-btn {
    background-color: var(--bg-tertiary);
    color: var(--text-primary);
  }
  
  .edit-goal-btn:hover {
    background-color: var(--border-color);
  }
  
  .delete-goal-btn {
    background-color: rgba(239, 68, 68, 0.1);
    color: var(--danger-color);
  }
  
  .delete-goal-btn:hover {
    background-color: rgba(239, 68, 68, 0.2);
  }
`;
            document.head.appendChild(style);
          }

          // Add event listeners to goal action buttons
          document.querySelectorAll(".edit-goal-btn").forEach((btn) => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              editGoal(id);
            });
          });

          document.querySelectorAll(".delete-goal-btn").forEach((btn) => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              deleteGoal(id);
            });
          });
        }

        function openGoalModal(goalId = null) {
          // Create modal if it doesn't exist
          if (!document.getElementById("goal-modal")) {
            const modal = document.createElement("div");
            modal.className = "modal";
            modal.id = "goal-modal";
            modal.innerHTML = `
  <div class="modal-content">
    <div class="modal-header">
      <h3>Add Goal</h3>
      <button class="close-modal">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      <form id="goal-form">
        <input type="hidden" id="goal-id">
        <div class="form-group">
          <label for="goal-name">Goal Name</label>
          <input type="text" id="goal-name" required>
        </div>
        <div class="form-group">
          <label for="goal-target-amount">Target Amount</label>
          <div class="amount-input">
            <span class="currency-symbol">₹</span>
            <input type="number" id="goal-target-amount" step="0.01" min="0.01" required>
          </div>
        </div>
        <div class="form-group">
          <label for="goal-current-amount">Current Amount</label>
          <div class="amount-input">
            <span class="currency-symbol">₹</span>
            <input type="number" id="goal-current-amount" step="0.01" min="0" required>
          </div>
        </div>
        <div class="form-group">
          <label for="goal-deadline">Deadline</label>
          <input type="date" id="goal-deadline" required>
        </div>
        <div class="form-group">
          <label for="goal-priority">Priority</label>
          <select id="goal-priority" required>
            <option value="high">High</option>
            <option value="medium" selected>Medium</option>
            <option value="low">Low</option>
          </select>
        </div>
        <div class="form-group">
          <label>Color</label>
          <div class="color-options">
            <div class="color-option" data-color="#6366f1" style="background-color: #6366f1"></div>
            <div class="color-option" data-color="#f43f5e" style="background-color: #f43f5e"></div>
            <div class="color-option" data-color="#10b981" style="background-color: #10b981"></div>
            <div class="color-option" data-color="#f59e0b" style="background-color: #f59e0b"></div>
            <div class="color-option" data-color="#3b82f6" style="background-color: #3b82f6"></div>
            <div class="color-option" data-color="#8b5cf6" style="background-color: #8b5cf6"></div>
          </div>
          <input type="hidden" id="goal-color" required>
        </div>
        <div class="form-group">
          <label for="goal-notes">Notes (Optional)</label>
          <textarea id="goal-notes"></textarea>
        </div>
        <div class="form-actions">
          <button type="button" class="cancel-btn">Cancel</button>
          <button type="submit" class="save-btn">Save Goal</button>
        </div>
      </form>
    </div>
  </div>
`;
            document.body.appendChild(modal);

            // Add event listeners
            const closeBtn = modal.querySelector(".close-modal");
            const cancelBtn = modal.querySelector(".cancel-btn");
            const form = modal.querySelector("#goal-form");
            const colorOptions = modal.querySelectorAll(".color-option");

            closeBtn.addEventListener("click", () => {
              closeModal(modal);
            });

            cancelBtn.addEventListener("click", () => {
              closeModal(modal);
            });

            colorOptions.forEach((option) => {
              option.addEventListener("click", () => {
                colorOptions.forEach((opt) => opt.classList.remove("selected"));
                option.classList.add("selected");
                document.getElementById("goal-color").value =
                  option.getAttribute("data-color");
              });
            });

            form.addEventListener("submit", handleGoalSubmit);
          }

          const modal = document.getElementById("goal-modal");
          const form = modal.querySelector("#goal-form");
          const goalIdInput = document.getElementById("goal-id");
          const goalNameInput = document.getElementById("goal-name");
          const goalTargetAmountInput =
            document.getElementById("goal-target-amount");
          const goalCurrentAmountInput = document.getElementById(
            "goal-current-amount"
          );
          const goalDeadlineInput = document.getElementById("goal-deadline");
          const goalPrioritySelect = document.getElementById("goal-priority");
          const goalColorInput = document.getElementById("goal-color");
          const goalNotesInput = document.getElementById("goal-notes");
          const colorOptions = modal.querySelectorAll(".color-option");

          // Reset form
          form.reset();
          colorOptions.forEach((option) => option.classList.remove("selected"));
          goalColorInput.value = "";

          // Set default deadline (3 months from now)
          const defaultDeadline = new Date();
          defaultDeadline.setMonth(defaultDeadline.getMonth() + 3);
          goalDeadlineInput.valueAsDate = defaultDeadline;

          // If editing existing goal
          if (goalId) {
            const goal = state.goals.find((g) => g.id === goalId);

            if (goal) {
              modal.querySelector(".modal-header h3").textContent = "Edit Goal";

              goalIdInput.value = goal.id;
              goalNameInput.value = goal.name;
              goalTargetAmountInput.value = goal.targetAmount;
              goalCurrentAmountInput.value = goal.currentAmount;
              goalDeadlineInput.value = goal.deadline;
              goalPrioritySelect.value = goal.priority;
              goalColorInput.value = goal.color;
              goalNotesInput.value = goal.notes || "";

              // Select the color option
              colorOptions.forEach((option) => {
                if (option.getAttribute("data-color") === goal.color) {
                  option.classList.add("selected");
                }
              });
            }
          } else {
            modal.querySelector(".modal-header h3").textContent = "Add Goal";
            goalIdInput.value = "";

            // Select default color
            const defaultColorOption = colorOptions[0];
            defaultColorOption.classList.add("selected");
            goalColorInput.value =
              defaultColorOption.getAttribute("data-color");
          }

          // Open modal
          openModal(modal);
        }

        function handleGoalSubmit(e) {
          e.preventDefault();

          const goalId = document.getElementById("goal-id").value;
          const name = document.getElementById("goal-name").value;
          const targetAmount = parseFloat(
            document.getElementById("goal-target-amount").value
          );
          const currentAmount = parseFloat(
            document.getElementById("goal-current-amount").value
          );
          const deadline = document.getElementById("goal-deadline").value;
          const priority = document.getElementById("goal-priority").value;
          const color = document.getElementById("goal-color").value;
          const notes = document.getElementById("goal-notes").value;

          if (!color) {
            alert("Please select a color");
            return;
          }

          if (goalId) {
            // Update existing goal
            const index = state.goals.findIndex((g) => g.id === goalId);

            if (index !== -1) {
              state.goals[index] = {
                ...state.goals[index],
                name,
                targetAmount,
                currentAmount,
                deadline,
                priority,
                color,
                notes,
                updatedAt: new Date().toISOString(),
              };
            }
          } else {
            // Create new goal
            const newGoal = {
              id: generateId(),
              name,
              targetAmount,
              currentAmount,
              deadline,
              priority,
              color,
              notes,
              createdAt: new Date().toISOString(),
            };

            state.goals.push(newGoal);
          }

          // Update UI
          updateGoalsSection();

          // Save data
          saveData();

          // Close modal
          closeModal(document.getElementById("goal-modal"));
        }

        function editGoal(id) {
          openGoalModal(id);
        }

        function deleteGoal(id) {
          if (confirm("Are you sure you want to delete this goal?")) {
            state.goals = state.goals.filter((g) => g.id !== id);
            updateGoalsSection();
            saveData();
          }
        }

        // Report Functions
        function generateReport() {
          const type = state.reports.type;
          const startDate = reportStartDate.value;
          const endDate = reportEndDate.value;

          if (!startDate || !endDate) {
            alert("Please select a date range");
            return;
          }

          if (new Date(startDate) > new Date(endDate)) {
            alert("Start date cannot be after end date");
            return;
          }

          // Filter transactions by date range
          const filteredTransactions = state.transactions.filter(
            (transaction) => {
              return (
                transaction.date >= startDate && transaction.date <= endDate
              );
            }
          );

          // Generate report based on type
          let reportData;
          if (type === "monthly") {
            reportData = generateMonthlyReport(
              filteredTransactions,
              startDate,
              endDate
            );
          } else if (type === "category") {
            reportData = generateCategoryReport(filteredTransactions);
          } else if (type === "trend") {
            reportData = generateTrendReport(
              filteredTransactions,
              startDate,
              endDate
            );
          }

          // Store report data
          state.reports.startDate = startDate;
          state.reports.endDate = endDate;
          state.reports.data = reportData;

          // Display report
          displayReport(reportData, type);
        }

        function generateMonthlyReport(transactions, startDate, endDate) {
          const income = transactions
            .filter((t) => t.type === "inc")
            .reduce((sum, t) => sum + t.amount, 0);

          const expenses = transactions
            .filter((t) => t.type === "exp")
            .reduce((sum, t) => sum + t.amount, 0);

          const balance = income - expenses;
          const savingsRate =
            income > 0 ? Math.round((balance / income) * 100) : 0;

          // Group expenses by category
          const expensesByCategory = {};
          transactions
            .filter((t) => t.type === "exp")
            .forEach((t) => {
              if (!expensesByCategory[t.category]) {
                expensesByCategory[t.category] = 0;
              }
              expensesByCategory[t.category] += t.amount;
            });

          // Sort categories by amount
          const sortedCategories = Object.entries(expensesByCategory)
            .map(([id, amount]) => {
              const category = state.categories.exp.find((c) => c.id === id);
              return {
                id,
                name: category ? category.name : id,
                color: category ? category.color : "#999",
                amount,
                percentage: Math.round((amount / expenses) * 100),
              };
            })
            .sort((a, b) => b.amount - a.amount);

          // Group transactions by day
          const transactionsByDay = {};
          transactions.forEach((t) => {
            if (!transactionsByDay[t.date]) {
              transactionsByDay[t.date] = {
                income: 0,
                expenses: 0,
              };
            }

            if (t.type === "inc") {
              transactionsByDay[t.date].income += t.amount;
            } else {
              transactionsByDay[t.date].expenses += t.amount;
            }
          });

          return {
            summary: {
              income,
              expenses,
              balance,
              savingsRate,
              transactionCount: transactions.length,
              dateRange: {
                start: startDate,
                end: endDate,
              },
            },
            categories: sortedCategories,
            daily: Object.entries(transactionsByDay).map(([date, data]) => ({
              date,
              income: data.income,
              expenses: data.expenses,
              balance: data.income - data.expenses,
            })),
          };
        }

        function generateCategoryReport(transactions) {
          // Group income by category
          const incomeByCategory = {};
          transactions
            .filter((t) => t.type === "inc")
            .forEach((t) => {
              if (!incomeByCategory[t.category]) {
                incomeByCategory[t.category] = 0;
              }
              incomeByCategory[t.category] += t.amount;
            });

          // Group expenses by category
          const expensesByCategory = {};
          transactions
            .filter((t) => t.type === "exp")
            .forEach((t) => {
              if (!expensesByCategory[t.category]) {
                expensesByCategory[t.category] = 0;
              }
              expensesByCategory[t.category] += t.amount;
            });

          // Calculate totals
          const totalIncome = Object.values(incomeByCategory).reduce(
            (sum, amount) => sum + amount,
            0
          );
          const totalExpenses = Object.values(expensesByCategory).reduce(
            (sum, amount) => sum + amount,
            0
          );

          // Format income categories
          const incomeCategories = Object.entries(incomeByCategory).map(
            ([id, amount]) => {
              const category = state.categories.inc.find((c) => c.id === id);
              return {
                id,
                name: category ? category.name : id,
                color: category ? category.color : "#999",
                amount,
                percentage:
                  totalIncome > 0
                    ? Math.round((amount / totalIncome) * 100)
                    : 0,
              };
            }
          );

          // Format expense categories
          const expenseCategories = Object.entries(expensesByCategory).map(
            ([id, amount]) => {
              const category = state.categories.exp.find((c) => c.id === id);
              return {
                id,
                name: category ? category.name : id,
                color: category ? category.color : "#999",
                amount,
                percentage:
                  totalExpenses > 0
                    ? Math.round((amount / totalExpenses) * 100)
                    : 0,
              };
            }
          );

          return {
            income: {
              total: totalIncome,
              categories: incomeCategories.sort((a, b) => b.amount - a.amount),
            },
            expenses: {
              total: totalExpenses,
              categories: expenseCategories.sort((a, b) => b.amount - a.amount),
            },
            balance: totalIncome - totalExpenses,
          };
        }

        function generateTrendReport(transactions, startDate, endDate) {
          // Create date range
          const start = new Date(startDate);
          const end = new Date(endDate);
          const dateRange = [];

          // Group by month
          const months = {};
          const monthNames = [
            "January",
            "February",
            "March",
            "April",
            "May",
            "June",
            "July",
            "August",
            "September",
            "October",
            "November",
            "December",
          ];

          // Initialize months in range
          let currentDate = new Date(start);
          while (currentDate <= end) {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const monthKey = `${year}-${month}`;

            if (!months[monthKey]) {
              months[monthKey] = {
                label: `${monthNames[month]} ${year}`,
                income: 0,
                expenses: 0,
                balance: 0,
              };
            }

            // Move to next month
            currentDate.setMonth(currentDate.getMonth() + 1);
          }

          // Add transactions to months
          transactions.forEach((t) => {
            const date = new Date(t.date);
            const year = date.getFullYear();
            const month = date.getMonth();
            const monthKey = `${year}-${month}`;

            if (months[monthKey]) {
              if (t.type === "inc") {
                months[monthKey].income += t.amount;
              } else {
                months[monthKey].expenses += t.amount;
              }
            }
          });

          // Calculate balance and sort by date
          Object.values(months).forEach((month) => {
            month.balance = month.income - month.expenses;
          });

          const sortedMonths = Object.entries(months)
            .sort(([keyA], [keyB]) => keyA.localeCompare(keyB))
            .map(([_, data]) => data);

          // Calculate averages
          const avgIncome =
            sortedMonths.reduce((sum, m) => sum + m.income, 0) /
            sortedMonths.length;
          const avgExpenses =
            sortedMonths.reduce((sum, m) => sum + m.expenses, 0) /
            sortedMonths.length;
          const avgBalance =
            sortedMonths.reduce((sum, m) => sum + m.balance, 0) /
            sortedMonths.length;

          return {
            months: sortedMonths,
            averages: {
              income: avgIncome,
              expenses: avgExpenses,
              balance: avgBalance,
            },
          };
        }

        function displayReport(reportData, type) {
          const reportContent = document.querySelector(".report-content");

          if (!reportData) {
            reportContent.innerHTML = `
  <div class="empty-state">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M18 20V10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M12 20V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M6 20V14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <p>Select date range and generate report</p>
  </div>
`;
            return;
          }

          // Create report HTML based on type
          let reportHTML = "";

          if (type === "monthly") {
            const { summary, categories, daily } = reportData;

            reportHTML = `
  <div class="report-section">
    <h3>Monthly Summary</h3>
    <div class="report-summary">
      <div class="summary-item">
        <span class="label">Total Income</span>
        <span class="value income">${formatCurrency(summary.income)}</span>
      </div>
      <div class="summary-item">
        <span class="label">Total Expenses</span>
        <span class="value expense">${formatCurrency(summary.expenses)}</span>
      </div>
      <div class="summary-item">
        <span class="label">Balance</span>
        <span class="value ${
          summary.balance >= 0 ? "income" : "expense"
        }">${formatCurrency(summary.balance)}</span>
      </div>
      <div class="summary-item">
        <span class="label">Savings Rate</span>
        <span class="value">${summary.savingsRate}%</span>
      </div>
    </div>
  </div>
  
  <div class="report-section">
    <h3>Top Expense Categories</h3>
    <div class="category-breakdown">
      ${categories
        .slice(0, 5)
        .map(
          (category) => `
        <div class="category-item">
          <div class="category-header">
            <span class="category-name">
              <span class="category-color" style="background-color: ${
                category.color
              }"></span>
              ${category.name}
            </span>
            <span class="category-amount">${formatCurrency(
              category.amount
            )}</span>
          </div>
          <div class="category-progress-container">
            <div class="category-progress-bar" style="width: ${
              category.percentage
            }%; background-color: ${category.color}"></div>
          </div>
          <div class="category-percentage">${category.percentage}%</div>
        </div>
      `
        )
        .join("")}
    </div>
  </div>
  
  <div class="report-section">
    <h3>Daily Breakdown</h3>
    <div class="daily-breakdown">
      <canvas id="daily-chart" height="200"></canvas>
    </div>
  </div>
`;

            reportContent.innerHTML = reportHTML;

            // Create daily chart
            const ctx = document.getElementById("daily-chart").getContext("2d");
            const dailyChart = new Chart(ctx, {
              type: "line",
              data: {
                labels: daily.map((d) => formatDate(d.date)),
                datasets: [
                  {
                    label: "Income",
                    data: daily.map((d) => d.income),
                    borderColor: "#10b981",
                    backgroundColor: "rgba(16, 185, 129, 0.1)",
                    tension: 0.4,
                  },
                  {
                    label: "Expenses",
                    data: daily.map((d) => d.expenses),
                    borderColor: "#ef4444",
                    backgroundColor: "rgba(239, 68, 68, 0.1)",
                    tension: 0.4,
                  },
                  {
                    label: "Balance",
                    data: daily.map((d) => d.balance),
                    borderColor: "#6366f1",
                    backgroundColor: "rgba(99, 102, 241, 0.1)",
                    tension: 0.4,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                  y: {
                    beginAtZero: true,
                    grid: {
                      color:
                        state.theme === "dark"
                          ? "rgba(255, 255, 255, 0.1)"
                          : "rgba(0, 0, 0, 0.1)",
                    },
                  },
                  x: {
                    grid: {
                      color:
                        state.theme === "dark"
                          ? "rgba(255, 255, 255, 0.1)"
                          : "rgba(0, 0, 0, 0.1)",
                    },
                  },
                },
                plugins: {
                  legend: {
                    labels: {
                      color: state.theme === "dark" ? "#f1f5f9" : "#1e293b",
                    },
                  },
                },
              },
            });
          } else if (type === "category") {
            const { income, expenses, balance } = reportData;

            reportHTML = `
  <div class="report-section">
    <h3>Category Summary</h3>
    <div class="report-summary">
      <div class="summary-item">
        <span class="label">Total Income</span>
        <span class="value income">${formatCurrency(income.total)}</span>
      </div>
      <div class="summary-item">
        <span class="label">Total Expenses</span>
        <span class="value expense">${formatCurrency(expenses.total)}</span>
      </div>
      <div class="summary-item">
        <span class="label">Balance</span>
        <span class="value ${
          balance >= 0 ? "income" : "expense"
        }">${formatCurrency(balance)}</span>
      </div>
    </div>
  </div>
  
  <div class="report-section">
    <h3>Income Categories</h3>
    <div class="category-charts">
      <div class="chart-container">
        <canvas id="income-category-chart" height="200"></canvas>
      </div>
      <div class="category-breakdown">
        ${income.categories
          .map(
            (category) => `
          <div class="category-item">
            <div class="category-header">
              <span class="category-name">
                <span class="category-color" style="background-color: ${
                  category.color
                }"></span>
                ${category.name}
              </span>
              <span class="category-amount">${formatCurrency(
                category.amount
              )}</span>
            </div>
            <div class="category-progress-container">
              <div class="category-progress-bar" style="width: ${
                category.percentage
              }%; background-color: ${category.color}"></div>
            </div>
            <div class="category-percentage">${category.percentage}%</div>
          </div>
        `
          )
          .join("")}
      </div>
    </div>
  </div>
  
  <div class="report-section">
    <h3>Expense Categories</h3>
    <div class="category-charts">
      <div class="chart-container">
        <canvas id="expense-category-chart" height="200"></canvas>
      </div>
      <div class="category-breakdown">
        ${expenses.categories
          .map(
            (category) => `
          <div class="category-item">
            <div class="category-header">
              <span class="category-name">
                <span class="category-color" style="background-color: ${
                  category.color
                }"></span>
                ${category.name}
              </span>
              <span class="category-amount">${formatCurrency(
                category.amount
              )}</span>
            </div>
            <div class="category-progress-container">
              <div class="category-progress-bar" style="width: ${
                category.percentage
              }%; background-color: ${category.color}"></div>
            </div>
            <div class="category-percentage">${category.percentage}%</div>
          </div>
        `
          )
          .join("")}
      </div>
    </div>
  </div>
`;

            reportContent.innerHTML = reportHTML;

            // Create income category chart
            const incomeCtx = document
              .getElementById("income-category-chart")
              .getContext("2d");
            const incomeCategoryChart = new Chart(incomeCtx, {
              type: "doughnut",
              data: {
                labels: income.categories.map((c) => c.name),
                datasets: [
                  {
                    data: income.categories.map((c) => c.amount),
                    backgroundColor: income.categories.map((c) => c.color),
                    borderWidth: 1,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: {
                    position: "right",
                    labels: {
                      color: state.theme === "dark" ? "#f1f5f9" : "#1e293b",
                    },
                  },
                },
              },
            });

            // Create expense category chart
            const expenseCtx = document
              .getElementById("expense-category-chart")
              .getContext("2d");
            const expenseCategoryChart = new Chart(expenseCtx, {
              type: "doughnut",
              data: {
                labels: expenses.categories.map((c) => c.name),
                datasets: [
                  {
                    data: expenses.categories.map((c) => c.amount),
                    backgroundColor: expenses.categories.map((c) => c.color),
                    borderWidth: 1,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: {
                    position: "right",
                    labels: {
                      color: state.theme === "dark" ? "#f1f5f9" : "#1e293b",
                    },
                  },
                },
              },
            });
          } else if (type === "trend") {
            const { months, averages } = reportData;

            reportHTML = `
  <div class="report-section">
    <h3>Monthly Trends</h3>
    <div class="trend-chart">
      <canvas id="trend-chart" height="250"></canvas>
    </div>
  </div>
  
  <div class="report-section">
    <h3>Monthly Averages</h3>
    <div class="report-summary">
      <div class="summary-item">
        <span class="label">Average Income</span>
        <span class="value income">${formatCurrency(averages.income)}</span>
      </div>
      <div class="summary-item">
        <span class="label">Average Expenses</span>
        <span class="value expense">${formatCurrency(averages.expenses)}</span>
      </div>
      <div class="summary-item">
        <span class="label">Average Balance</span>
        <span class="value ${
          averages.balance >= 0 ? "income" : "expense"
        }">${formatCurrency(averages.balance)}</span>
      </div>
    </div>
  </div>
  
  <div class="report-section">
    <h3>Monthly Breakdown</h3>
    <div class="monthly-breakdown">
      <table class="monthly-table">
        <thead>
          <tr>
            <th>Month</th>
            <th>Income</th>
            <th>Expenses</th>
            <th>Balance</th>
          </tr>
        </thead>
        <tbody>
          ${months
            .map(
              (month) => `
            <tr>
              <td>${month.label}</td>
              <td class="income">${formatCurrency(month.income)}</td>
              <td class="expense">${formatCurrency(month.expenses)}</td>
              <td class="${
                month.balance >= 0 ? "income" : "expense"
              }">${formatCurrency(month.balance)}</td>
            </tr>
          `
            )
            .join("")}
        </tbody>
      </table>
    </div>
  </div>
`;

            reportContent.innerHTML = reportHTML;

            // Create trend chart
            const trendCtx = document
              .getElementById("trend-chart")
              .getContext("2d");
            const trendChart = new Chart(trendCtx, {
              type: "line",
              data: {
                labels: months.map((m) => m.label),
                datasets: [
                  {
                    label: "Income",
                    data: months.map((m) => m.income),
                    borderColor: "#10b981",
                    backgroundColor: "rgba(16, 185, 129, 0.1)",
                    tension: 0.4,
                  },
                  {
                    label: "Expenses",
                    data: months.map((m) => m.expenses),
                    borderColor: "#ef4444",
                    backgroundColor: "rgba(239, 68, 68, 0.1)",
                    tension: 0.4,
                  },
                  {
                    label: "Balance",
                    data: months.map((m) => m.balance),
                    borderColor: "#6366f1",
                    backgroundColor: "rgba(99, 102, 241, 0.1)",
                    tension: 0.4,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                  y: {
                    beginAtZero: true,
                    grid: {
                      color:
                        state.theme === "dark"
                          ? "rgba(255, 255, 255, 0.1)"
                          : "rgba(0, 0, 0, 0.1)",
                    },
                  },
                  x: {
                    grid: {
                      color:
                        state.theme === "dark"
                          ? "rgba(255, 255, 255, 0.1)"
                          : "rgba(0, 0, 0, 0.1)",
                    },
                  },
                },
                plugins: {
                  legend: {
                    labels: {
                      color: state.theme === "dark" ? "#f1f5f9" : "#1e293b",
                    },
                  },
                },
              },
            });
          }

          // Add CSS for report
          if (!document.getElementById("report-styles")) {
            const style = document.createElement("style");
            style.id = "report-styles";
            style.textContent = `
  .report-section {
    background-color: var(--bg-primary);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
    box-shadow: var(--shadow);
  }
  
  .report-section h3 {
    margin-bottom: var(--spacing-md);
    font-size: var(--text-lg);
    font-weight: var(--font-medium);
  }
  
  .report-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
  }
  
  .summary-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
  }
  
  .summary-item .label {
    font-size: var(--text-sm);
    color: var(--text-secondary);
  }
  
  .summary-item .value {
    font-size: var(--text-xl);
    font-weight: var(--font-semibold);
  }
  
  .value.income {
    color: var(--income-color);
  }
  
  .value.expense {
    color: var(--expense-color);
  }
  
  .category-breakdown {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
  }
  
  .category-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
  }
  
  .category-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .category-name {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-weight: var(--font-medium);
  }
  
  .category-color {
    width: 12px;
    height: 12px;
    border-radius: var(--radius-full);
  }
  
  .category-amount {
    font-weight: var(--font-medium);
  }
  
  .category-progress-container {
    height: 6px;
    background-color: var(--bg-tertiary);
    border-radius: var(--radius-full);
    overflow: hidden;
  }
  
  .category-progress-bar {
    height: 100%;
    border-radius: var(--radius-full);
  }
  
  .category-percentage {
    font-size: var(--text-xs);
    color: var(--text-secondary);
    text-align: right;
  }
  
  .category-charts {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-lg);
  }
  
  @media (min-width: 768px) {
    .category-charts {
      grid-template-columns: 1fr 1fr;
    }
  }
  
  .chart-container {
    position: relative;
    height: 250px;
  }
  
  .monthly-table {
    width: 100%;
    border-collapse: collapse;
  }
  
  .monthly-table th,
  .monthly-table td {
    padding: var(--spacing-sm);
    text-align: left;
    border-bottom: 1px solid var(--border-color);
  }
  
  .monthly-table th {
    font-weight: var(--font-medium);
    color: var(--text-secondary);
  }
  
  .monthly-table td.income {
    color: var(--income-color);
  }
  
  .monthly-table td.expense {
    color: var(--expense-color);
  }
`;
            document.head.appendChild(style);
          }
        }

        function exportReport() {
          if (!state.reports.data) {
            alert("Please generate a report first");
            return;
          }

          const reportType = state.reports.type;
          const startDate = state.reports.startDate;
          const endDate = state.reports.endDate;

          // Create CSV content based on report type
          let csvContent = "";

          if (reportType === "monthly") {
            const { summary, categories, daily } = state.reports.data;

            // Add summary
            csvContent += "Monthly Report Summary\n";
            csvContent += `Date Range,${formatDate(startDate)} to ${formatDate(
              endDate
            )}\n`;
            csvContent += `Total Income,${summary.income}\n`;
            csvContent += `Total Expenses,${summary.expenses}\n`;
            csvContent += `Balance,${summary.balance}\n`;
            csvContent += `Savings Rate,${summary.savingsRate}%\n\n`;

            // Add categories
            csvContent += "Expense Categories\n";
            csvContent += "Category,Amount,Percentage\n";
            categories.forEach((category) => {
              csvContent += `${category.name},${category.amount},${category.percentage}%\n`;
            });
            csvContent += "\n";

            // Add daily breakdown
            csvContent += "Daily Breakdown\n";
            csvContent += "Date,Income,Expenses,Balance\n";
            daily.forEach((day) => {
              csvContent += `${formatDate(day.date)},${day.income},${
                day.expenses
              },${day.balance}\n`;
            });
          } else if (reportType === "category") {
            const { income, expenses, balance } = state.reports.data;

            // Add summary
            csvContent += "Category Report Summary\n";
            csvContent += `Date Range,${formatDate(startDate)} to ${formatDate(
              endDate
            )}\n`;
            csvContent += `Total Income,${income.total}\n`;
            csvContent += `Total Expenses,${expenses.total}\n`;
            csvContent += `Balance,${balance}\n\n`;

            // Add income categories
            csvContent += "Income Categories\n";
            csvContent += "Category,Amount,Percentage\n";
            income.categories.forEach((category) => {
              csvContent += `${category.name},${category.amount},${category.percentage}%\n`;
            });
            csvContent += "\n";

            // Add expense categories
            csvContent += "Expense Categories\n";
            csvContent += "Category,Amount,Percentage\n";
            expenses.categories.forEach((category) => {
              csvContent += `${category.name},${category.amount},${category.percentage}%\n`;
            });
          } else if (reportType === "trend") {
            const { months, averages } = state.reports.data;

            // Add summary
            csvContent += "Trend Report Summary\n";
            csvContent += `Date Range,${formatDate(startDate)} to ${formatDate(
              endDate
            )}\n`;
            csvContent += `Average Income,${averages.income}\n`;
            csvContent += `Average Expenses,${averages.expenses}\n`;
            csvContent += `Average Balance,${averages.balance}\n\n`;

            // Add monthly breakdown
            csvContent += "Monthly Breakdown\n";
            csvContent += "Month,Income,Expenses,Balance\n";
            months.forEach((month) => {
              csvContent += `${month.label},${month.income},${month.expenses},${month.balance}\n`;
            });
          }

          // Create download link
          const blob = new Blob([csvContent], {
            type: "text/csv;charset=utf-8;",
          });
          const url = URL.createObjectURL(blob);
          const link = document.createElement("a");
          link.setAttribute("href", url);
          link.setAttribute(
            "download",
            `budget_report_${reportType}_${startDate}_to_${endDate}.csv`
          );
          link.style.visibility = "hidden";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        }

        // Data Persistence
        function saveData() {
          const data = {
            transactions: state.transactions,
            accounts: state.accounts,
            categories: state.categories,
            budgets: state.budgets,
            goals: state.goals,
          };

          localStorage.setItem("budgetTrackerData", JSON.stringify(data));
        }

        function loadData() {
          const savedData = localStorage.getItem("budgetTrackerData");

          if (savedData) {
            const data = JSON.parse(savedData);

            // Load saved data into state
            state.transactions = data.transactions || [];
            state.accounts = data.accounts || [];
            state.categories = data.categories || state.categories;
            state.budgets = data.budgets || [];
            state.goals = data.goals || [];
          } else {
            // Load demo data for first-time users
            loadDemoData();
          }
        }

        function loadDemoData() {
          // Demo accounts
          state.accounts = [
            {
              id: "demo-account-1",
              name: "Primary Checking",
              type: "checking",
              balance: 25000,
              accountNumber: "XXXX1234",
              createdAt: new Date().toISOString(),
            },
            {
              id: "demo-account-2",
              name: "Savings",
              type: "savings",
              balance: 50000,
              accountNumber: "XXXX5678",
              createdAt: new Date().toISOString(),
            },
          ];

          // Demo transactions
          const today = new Date();
          const currentMonth = today.getMonth();
          const currentYear = today.getFullYear();

          // Generate transactions for the current month
          const demoTransactions = [];

          // Income transactions
          demoTransactions.push({
            id: "demo-transaction-1",
            type: "inc",
            amount: 45000,
            description: "Salary",
            category: "salary",
            account: "demo-account-1",
            date: new Date(currentYear, currentMonth, 5)
              .toISOString()
              .split("T")[0],
            notes: "Monthly salary",
            createdAt: new Date().toISOString(),
          });

          demoTransactions.push({
            id: "demo-transaction-2",
            type: "inc",
            amount: 5000,
            description: "Freelance Work",
            category: "freelance",
            account: "demo-account-1",
            date: new Date(currentYear, currentMonth, 15)
              .toISOString()
              .split("T")[0],
            notes: "Website design project",
            createdAt: new Date().toISOString(),
          });

          // Expense transactions
          demoTransactions.push({
            id: "demo-transaction-3",
            type: "exp",
            amount: 12000,
            description: "Rent",
            category: "housing",
            account: "demo-account-1",
            date: new Date(currentYear, currentMonth, 2)
              .toISOString()
              .split("T")[0],
            notes: "Monthly rent",
            createdAt: new Date().toISOString(),
          });

          demoTransactions.push({
            id: "demo-transaction-4",
            type: "exp",
            amount: 3500,
            description: "Groceries",
            category: "food",
            account: "demo-account-1",
            date: new Date(currentYear, currentMonth, 8)
              .toISOString()
              .split("T")[0],
            notes: "Weekly grocery shopping",
            createdAt: new Date().toISOString(),
          });

          demoTransactions.push({
            id: "demo-transaction-5",
            type: "exp",
            amount: 1200,
            description: "Electricity Bill",
            category: "utilities",
            account: "demo-account-1",
            date: new Date(currentYear, currentMonth, 10)
              .toISOString()
              .split("T")[0],
            notes: "Monthly electricity bill",
            createdAt: new Date().toISOString(),
          });

          demoTransactions.push({
            id: "demo-transaction-6",
            type: "exp",
            amount: 2500,
            description: "Dining Out",
            category: "food",
            account: "demo-account-1",
            date: new Date(currentYear, currentMonth, 12)
              .toISOString()
              .split("T")[0],
            notes: "Dinner with friends",
            createdAt: new Date().toISOString(),
          });

          demoTransactions.push({
            id: "demo-transaction-7",
            type: "exp",
            amount: 1500,
            description: "Fuel",
            category: "transport",
            account: "demo-account-1",
            date: new Date(currentYear, currentMonth, 14)
              .toISOString()
              .split("T")[0],
            notes: "Car fuel",
            createdAt: new Date().toISOString(),
          });

          demoTransactions.push({
            id: "demo-transaction-8",
            type: "exp",
            amount: 3000,
            description: "Movie and Dinner",
            category: "entertainment",
            account: "demo-account-1",
            date: new Date(currentYear, currentMonth, 18)
              .toISOString()
              .split("T")[0],
            notes: "Weekend entertainment",
            createdAt: new Date().toISOString(),
          });

          // Add transactions to state
          state.transactions = demoTransactions;

          // Demo budgets
          state.budgets = [
            {
              id: "demo-budget-1",
              name: "Monthly Essentials",
              category: "housing",
              planned: 15000,
              spent: 12000,
              period: "monthly",
              startDate: new Date(currentYear, currentMonth, 1)
                .toISOString()
                .split("T")[0],
              endDate: new Date(currentYear, currentMonth + 1, 0)
                .toISOString()
                .split("T")[0],
              createdAt: new Date().toISOString(),
            },
            {
              id: "demo-budget-2",
              name: "Groceries",
              category: "food",
              planned: 6000,
              spent: 3500,
              period: "monthly",
              startDate: new Date(currentYear, currentMonth, 1)
                .toISOString()
                .split("T")[0],
              endDate: new Date(currentYear, currentMonth + 1, 0)
                .toISOString()
                .split("T")[0],
              createdAt: new Date().toISOString(),
            },
            {
              id: "demo-budget-3",
              name: "Entertainment",
              category: "entertainment",
              planned: 4000,
              spent: 3000,
              period: "monthly",
              startDate: new Date(currentYear, currentMonth, 1)
                .toISOString()
                .split("T")[0],
              endDate: new Date(currentYear, currentMonth + 1, 0)
                .toISOString()
                .split("T")[0],
              createdAt: new Date().toISOString(),
            },
          ];

          // Demo goals
          state.goals = [
            {
              id: "demo-goal-1",
              name: "Emergency Fund",
              targetAmount: 100000,
              currentAmount: 35000,
              deadline: new Date(currentYear + 1, 0, 1)
                .toISOString()
                .split("T")[0],
              priority: "high",
              color: "#6366f1",
              createdAt: new Date().toISOString(),
            },
            {
              id: "demo-goal-2",
              name: "Vacation",
              targetAmount: 25000,
              currentAmount: 12000,
              deadline: new Date(currentYear, currentMonth + 3, 1)
                .toISOString()
                .split("T")[0],
              priority: "medium",
              color: "#f59e0b",
              createdAt: new Date().toISOString(),
            },
            {
              id: "demo-goal-3",
              name: "New Laptop",
              targetAmount: 18000,
              currentAmount: 8000,
              deadline: new Date(currentYear, currentMonth + 6, 1)
                .toISOString()
                .split("T")[0],
              priority: "low",
              color: "#10b981",
              createdAt: new Date().toISOString(),
            },
          ];
        }

        // Initialize the app
        initApp();
      });

      console.log("Smart Budget Tracker Pro initialized successfully!");
    </script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script>
      document.getElementById("export-excel").addEventListener("click", () => {
        const table = document.querySelector(".transactions-table");
        const wb = XLSX.utils.table_to_book(table, { sheet: "Bank Statement" });
        XLSX.writeFile(wb, "BankStatement.xlsx");
      });
    </script>
  </body>
</html>
